@accountGroup
Feature: accountGroup Meta

@StepDef
#----------------------------------------------------------------------------------------
#Step to goto account group page.
#Example:And I go to the account group page
#----------------------------------------------------------------------------------------
  Scenario:I go to the account group page
    Given I navigate to module account group
    And heading should be "Account Groups"
    And smallmenubar should be displayed
    And I wait for accountGroupGrid text

@StepDef
#----------------------------------------------------------------------------------------
#Step to verify current page is account group page.
#Example:And I am on account group page
#----------------------------------------------------------------------------------------
  Scenario:I am on account group page
    And heading should be "Account Groups"
    And smallmenubar should be displayed
    And I wait for accountGroupGrid text

@StepDef
#-------------------------------------------------------------
#Step to apply account group filter
#Example:And I apply account group filter "Account:HDFAUDAC1"
#-------------------------------------------------------------
Scenario: I apply account group filter "<filter>"
    And filterIs is "$<filter>"
    And I wait for page to load
    And I wait for first row of accountGroupGrid
    And I enter account group filter "${selectFilter}" for each selectFilter in filterIs delimited by ";"


@StepDef
#-----------------------------------------------------------------
#Step to enter filter name in account group filter form
#Example:And I enter account group filter "Amount:90989.898"
#-----------------------------------------------------------------
Scenario: I enter account group filter "<filter>"
    And I get filter details for "$<filter>"
    And I scroll to account group ladder column "${filterNameIs}"
    And more option menu can be located by javascript
      """
      $('stl-account-group-grid span').filter(function() {
          return $(this).text() === "${filterNameIs}";
      }).parent().siblings().get(0);
      """
    And I click more option menu
    And I wait for filter menu
    And notOnFilterTab is defined by javascript "!$('[class="ag-icon ag-icon-filter"]').parent().hasClass("ag-tab-selected")"
    And I click filter menu if notOnFilterTab
    And setPerspectiveFilterInputField can be located by javascript "$('input[class="ag-filter-filter"]').get(0)"
    And setPerspectiveFilterToInputField can be located by javascript "$('input[class="ag-filter-filter"]').get(1)"
    And cbFilters is present is defined by javascript "(function() {return "${filterNameIs}" != "''" && "${filterNameIs}" != "IDEL Pool Limit"})();"
    And Amount filter is present is defined by javascript "(function() {return "${filterNameIs}" != "''" && "${filterNameIs}" == "IDEL Pool Limit"})();"
    And I set account group filter for cbfilter if cbFilters is present
    And I set account group filter for Amount if Amount filter is present
    And I scroll to first column of account group ladder
    And I click accountGroupGridHeader


@StepDef
#-----------------------------------------------
#Step for select filter checkbox from filter dialog
#Example:And I set account group filter for cbfilter
#------------------------------------------------
Scenario: I set account group filter for cbfilter
  And allSelected is defined by javascript
    """
      (function() {
        var result=false;
        if($('#selectAll').get(0)!=null)
          if($('#selectAll span').hasClass("ag-icon-checkbox-checked"))
            result=true;
        return result;
      })()
    """
  ##WA##And I click filter menu select all checkbox if allSelected
  And unselectAll is defined by javascript
    """
      (function() {
        var result="";
        if($('#selectAll').get(0)!=null){
          $('#selectAll').click();
          if(!($('#selectAll span').hasClass("ag-icon-checkbox-checked")))
            result="Done";
        }
        return result;
      })()
    """
  And unselectAll should be "Done"
  And firstFilterValue is defined by javascript "(function(){ return "${filterValueIs}".replace(/[^a-zA-Z\d.-][' ']/ig,"");})()" if perspectiveValue is present
  And I select "${enterFilter}" from dropdown for each enterFilter in firstFilterValue delimited by "," if perspectiveValue is present
  And I scroll to the bottom of heading
  And I click heading

@StepDef
#-----------------------------------------------
#Step for select filter from filter dialog
#Example:And I set account group filter for Amount
#------------------------------------------------
Scenario: I select "<firstFilterValue>" from dropdown
    And isNotBlank is defined by javascript "(function(){ return "$<firstFilterValue>"!="(Blanks)"})()"
    And I type "$<firstFilterValue>" in setPerspectiveFilterInputField if isNotBlank
    And I execute javascript "(function(){$('#richList span').each(function(){if($(this).text()==="$<firstFilterValue>") {element=$(this).parent()}}) ;return element.click()})()"
 

@StepDef
#-----------------------------------------------
#Step for select filter from filter dialog
#Example:And I set account group filter for Amount
#------------------------------------------------
Scenario: I set account group filter for Amount
  And I select "${filerCondition}" in filter condition selector if filerCondition is present
  And I select "${filerCondition}" in filter condition selector if filerInRange is present
  And firstFilterValue is defined by javascript "(function(){ return "${filterValueIs}".replace(/[^a-zA-Z\d.-][' ']/ig,"");})()" if filerCondition is present
  And firstFilterValue is defined by javascript "(function(){ return "${filterValueIs}".split("<>")[0];})()" if filerInRange is present
  And secondFilterValue is defined by javascript "(function(){ return "${filterValueIs}".split("<>")[1];})()" if filerInRange is present
  And I type "${firstFilterValue}" in setPerspectiveFilterInputField if perspectiveValue is present
  And I type "${secondFilterValue}" in setPerspectiveFilterToInputField if filerInRange is present

@StepDef
#-----------------------------------------------------------------
#Step to scroll to account group ladder column
#Example: And I scroll to account group ladder column "Trade Type"
#-----------------------------------------------------------------
Scenario: I scroll to account group ladder column "<columnName>"
  And I execute javascript "count=1;"
  And scrolling is defined by javascript
  """
  (function(){
  var result=""; var scrollDone="";var colId="";
  function scrollSearch(){
    scrollPos=$('stl-account-group-grid .ag-body-viewport').scrollLeft();
    $('stl-account-group-grid .ag-body-viewport').scrollLeft(200*(count++));
    console.log(scrollPos+"  "+count);
  }
  $('.ag-header-container .ag-header-cell span.ag-header-cell-text').filter(function()
  {
   if($(this).text().trim()=="$<columnName>")
   {
   $(this).parents().filter(function()
     {
     if($(this).attr('col-id')!=null)
       {
         colId=$(this).attr('col-id')
       }
     }
   )}
 })
  if($('stl-account-group-grid [col-id*="'+colId+'"] span:contains("$<columnName>")').parent().siblings().get(0)==null){
    console.log("in if");
    scrollSearch();
  }else{
    console.log("in else");
    result="Done";
  }
  return result;

  })()
  """
  And scrolling should be "Done"


@StepDef
#-----------------------------------------------------------------
#Step to scroll to the first account group ladder column
#Example: And I scroll to first column of account group ladder
#-----------------------------------------------------------------
Scenario:I scroll to first column of account group ladder
And I execute javascript
  """
  $('stl-account-group-grid .ag-body-viewport').scrollLeft(0);
  """

@StepDef
#-------------------------------------------------------------
#Step to remove account group filter
#Example:And I remove account group filter "Account:HDFAUDAC1"
#-------------------------------------------------------------
Scenario:I remove account group filter for "<filter>"
  And filterIs is "$<filter>"
  And I remove account group filter "${selectFilter}" for each selectFilter in filterIs delimited by ";"

@StepDef
#-----------------------------------------------------------------
#Step to remove account group filter
#Example: I remove account group filter on account group
#-----------------------------------------------------------------
Scenario: I remove account group filter "<filter>"
    And I get filter details for "$<filter>"
    And I scroll to account group ladder column "${filterNameIs}"
    And more option menu can be located by javascript
    """
    $('stl-account-group-grid span').filter(function() {
        return $(this).text() === "${filterNameIs}";
    }).parent().siblings().get(0);
    """
    And I click more option menu
    And I wait for filter menu
    And notOnFilterTab is defined by javascript "!$('[class="ag-icon ag-icon-filter"]').parent().hasClass("ag-tab-selected")"
    And I click filter menu if notOnFilterTab
    And setPerspectiveFilterInputField can be located by javascript "$('input[class="ag-filter-filter"]').get(0)"
    And setPerspectiveFilterToInputField can be located by javascript "$('input[class="ag-filter-filter"]').get(1)"
    And cbFilters is present is defined by javascript "(function() {return "${filterNameIs}" != "''" && "${filterNameIs}" != "Value Date" && "${filterNameIs}" != "IDEL Pool Limit"})();"
    And Amount filter is present is defined by javascript "(function() {return "${filterNameIs}" != "''" && "${filterNameIs}" == "IDEL Pool Limit"})();"
    And I unset account group filter for cbfilter if cbFilters is present
    And I unset account group filter for amount if Amount filter is present
    And I scroll to first column of account group ladder
    And I click accountGroupGridHeader

@StepDef
#----------------------------------------------
#Step to deselect selected filter from filter dialog box
#Example:And I unset account group filter for cbfilter
#-----------------------------------------------
Scenario: I unset account group filter for cbfilter
    And I clear setPerspectiveFilterInputField if perspectiveValue is present
    And I type "a" in setPerspectiveFilterInputField if perspectiveValue is present
    And I wait 3 seconds if perspectiveValue is present
    And I send "BACK_SPACE" to setPerspectiveFilterInputField if perspectiveValue is present
    And allUnselected is defined by javascript
    """
      (function() {
        var result=true;
        if($('#selectAll').get(0)!=null)
          if($('#selectAll span').hasClass("ag-icon-checkbox-checked"))
            result=false;
        return result;
      })()
    """
    ##WA##And I click filter menu select all checkbox if allUnselected
    And selectAll is defined by javascript
      """
        (function() {
          var result="";
          if($('#selectAll').get(0)!=null){
            $('#selectAll').click();
            if($('#selectAll span').hasClass("ag-icon-checkbox-checked"))
              result="Done";
          }
          return result;
        })()
      """
    And selectAll should be "Done"


@StepDef
#----------------------------------------------
#Step to deselect selected filter of ammount from filter dialog box
#Example:And I unset account group filter for amount
#-----------------------------------------------
Scenario: I unset account group filter for amount
    And I clear setPerspectiveFilterInputField if perspectiveValue is present
    And I type "a" in setPerspectiveFilterInputField if perspectiveValue is present
    And I wait 3 seconds if perspectiveValue is present
    And I send "BACK_SPACE" to setPerspectiveFilterInputField if perspectiveValue is present
    And I clear setPerspectiveFilterToInputField if filerInRange is present
    And I type "a" in setPerspectiveFilterToInputField if filerInRange is present
    And I wait 3 seconds if filerInRange is present
    And I send "BACK_SPACE" to setPerspectiveFilterToInputField if filerInRange is present


@StepDef
#-------------------------------------------------------------
#Step to get export of account group grid
#Example:And I verify account group dashboard csv for "<testcaseNo>"
#-------------------------------------------------------------
Scenario: I verify account group dashboard csv for "<testcaseNo>"
    And I scroll to top of page
    And I wait for first row of accountGroupGrid
    And I right click first row of accountGroupGrid
    And I wait for export button
    And I click export button
    And I wait for export to csv button
    And export to csv button should be displayed
    And export to excel button should be displayed
    And dropdownList is defined by javascript "(function(){return $('.ag-menu').length})()"
    And dropdownList should be "2"
    And I click export to csv button
    And I save file using "," as delimiter with sort on "none" for "$<testcaseNo>"
    And I compare result for "$<testcaseNo>"
    And testcaseIs is "$<testcaseNo>:''"
    And I verify testresult of testcasesno "${testcaseNoIs}" for each testcaseNoIs in testcaseIs delimited by ":"

@StepDef
#-------------------------------------------------------------
#Step to get export of account group history  grid
#Example:And I verify account group history dashboard csv for "<testcaseNo>"
#-------------------------------------------------------------
Scenario: I verify account group history dashboard csv for "<testcaseNo>"
    And I scroll to the top of accountGroupHistoryGridHeader
    And I wait for first row of accountGroupHistoryGrid
    And I right click first row of accountGroupHistoryGrid
    And I wait for export button
    And I click export button
    And export to csv button should be displayed
    And export to excel button should be displayed
    And dropdownList is defined by javascript "(function(){return $('.ag-menu').length})()"
    And dropdownList should be "2"
    And I wait for export to csv button
    And I click export to csv button
    And I save file using "," as delimiter with sort on "none" for "$<testcaseNo>"
    And I compare result for "$<testcaseNo>"
    And testcaseIs is "$<testcaseNo>:''"
    And I verify testresult of testcasesno "${testcaseNoIs}" for each testcaseNoIs in testcaseIs delimited by ":"

@StepDef
#-------------------------------------------------------------
#Step to  login with functional user to edit pool
#Example:And I login as "funcational" user to edit "oldvalue" of grpup "group1" to "newvalur"
#-------------------------------------------------------------
Scenario:I login as "<userName>" user to edit "<changeValueOf>" of grpup "<GroupToEdit>" to "<dataValue>"
      And I login as "$<userName>" user
      And I go to the account group page
      And I open group "$<GroupToEdit>" to edit
      And I select "$<dataValue>" from "$<changeValueOf>" in account group form
      And I save and confirm account group 
      And I verify text for "$<changeValueOf>" is "$<dataValue>" for account group
     And I scroll to top of page
      And I click accountGroupPage


@StepDef
#-------------------------------------------------------------
#Step to login with approval user to approve pool
#Example:And I login as "approval" user to approve account group "group1"
#-------------------------------------------------------------
Scenario:I login as "<userName>" user to approve account group "<groupName>"
      And I login as "$<userName>" user
      And I go to the account group page
      And I approve account group "$<groupName>"

@StepDef
#-------------------------------------------------------------
#Step to edit pool
#Story ID:CMS-10168,CMS-10181
#TC Mapping:PoolUI TC-50,85
#Example:And I open group "<groupName>" to edit
#-------------------------------------------------------------
Scenario: I navigate to ladder page to verify balance for "<testcasesNo>"
      And I navigate to home page
      And I go to the ladder page
      And I wait for page to load
      And I select group as "Default Group"
      And I select balanceType "Projected Balance - STANDARD:Projected Balance - CUMULATIVE:Actual Balance - STANDARD"
      And I verify balance for "$<testcasesNo>"

@StepDef
#-------------------------------------------------------------
#Step to edit group
#Example:And I  open group "<groupName>" to edit
#-------------------------------------------------------------
Scenario: I open group "<groupName>" to edit
  And I navigate to page of account group "$<groupName>"
  And I click editButton

@StepDef
@DataTable(header="top")
#----------------------------------------------------------------------------------------
#Step to edit pool
#Example:And I open group to edit
##|GroupToEdit|Account Group Type|Account Group Code|Email|Group|Currency|IDEL Limit|Pool Balance Type|Pool Type|Account Group Name|Address|Description|Bank Legal Entity|FX Rate Type|addAccounts|removeAccount|
##|TEST12123456|Pool|TEST121234|QaAutomation@smartstream-stp.com|Default Group|INR|100000|Only Short|NOSTRO|''|Address7|Description1|PFCLEG16|Bid Offer Rate|''|PFCLEG15-JPY-04;PFCLEG15-JPY-03|
#----------------------------------------------------------------------------------------
Scenario: I open group to edit
    And I edit account group "${data[GroupToEdit]}" "${data[Account Group Type]}" "${data[Account Group Code]}" "${data[Email]}" "${data[Group]}" "${data[Currency]}" "${data[IDEL Limit]}" "${data[Pool Balance Type]}" "${data[Account Group Name]}" "${data[Address]}" "${data[Description]}" "${data[Bank Legal Entity]}" "${data[FX Rate Type]}" "${data[addAccounts]}" "${data[removeAccount]}" for each data record


@StepDef
#----------------------------------------------------------------------------------------
#Step to edit pool
#Example:And I edit account group "TEST12123456" "Pool" "TEST121234" "QaAutomation@smartstream-stp.com " "Default Group" "INR" "100000" "Only Short" "NOSTRO" ""''" "Address7" "Description1" "PFCLEG16" "Bid Offer Rate" "''" "PFCLEG15-JPY-04" "PFCLEG15-JPY-03"
#----------------------------------------------------------------------------------------
Scenario:I edit account group "<GroupToEdit>" "<Account Group Type>" "<Account Group Code>" "<Email>" "<Group>" "<Currency>" "<IDEL Limit>" "<Pool Balance Type>" "<Account Group Name>" "<Address>" "<Description>" "<Bank Legal Entity>" "<FX Rate Type>" "<addAccounts>" "<removeAccount>"
Given notPresentOnAccountGroupPage is defined by javascript "(function(){return $('span b:contains("Account Groups")').length!=1})()"
  And I navigate to account group page if notPresentOnAccountGroupPage
  And I open group "$<GroupToEdit>" to edit
  And I add "$<Account Group Code>" in "Account Group Code" for account group form
  And I add "$<Email>" in "Email" for account group form
  And I select "$<Group>" from "Group" in account group form
  And I select "$<Currency>" from "Currency" in account group form
  And I add "$<IDEL Limit>" in "IDEL Limit" for account group form
  And I select "$<Pool Balance Type>" from "Pool Balance Type" in account group form
  And I add "$<Account Group Name>" in "Account Group Name" for account group form
  And I add "$<Address>" in "Address" for account group form
  And I add "$<Description>" in "Description" for account group form
  And I select "$<Bank Legal Entity>" from "Bank Legal Entity" in account group form
  And I select "$<FX Rate Type>" from "FX Rate Type" in account group form
  And I add accounts "$<addAccounts>" in account group form
  And I remove accounts "$<removeAccount>" in account group form
  And I save and confirm account group
  And I verify account group have "$<Account Group Type>" "$<Account Group Code>" "$<Email>" "$<Group>" "$<Currency>" "$<IDEL Limit>" "$<Pool Balance Type>" "$<Account Group Name>" "$<Address>" "$<Description>" "$<Bank Legal Entity>" "$<FX Rate Type>" "$<addAccounts>"
  And I scroll to top of page
  And I click accountGroupPage
  And groupNameEdited is defined by javascript "(function() {return "$<Account Group Name>" != "''"})();"
  And groupNameNotEdited is defined by javascript "(function() {return "$<Account Group Name>" == "''"})();"


@StepDef
#-------------------------------------------------------------
#Step to navigate to page of group
#Example:And  I navigate to page of account group "<groupName>"
#-------------------------------------------------------------
Scenario: I navigate to page of account group "<groupName>"
  And I apply account group filter "Name:$<groupName>"
  And I click first row of accountGroupGrid
  And I wait 2 seconds
  And I wait for page to load
  And header should be "$<groupName>"

@StepDef
@DataTable(header="top")
#----------------------------------------------------------------------------------------
#Verifies group details
#Example:  And I verify account group details in form
##    |Account Group Type|Account Group Code|Email|Group|Currency|IDEL Limit|Pool Balance Type|Pool Type|Account Group Name|Address|Description|Bank Legal Entity|FX Rate Type|accounts|
##    |Pool|TEST121234|QaAutomation@smartstream-stp.com|Default Group|INR|100000|Only Short|NOSTRO|TEST12123456|Address6|Description1|PFCLEG16|Bid Offer Rate|PFCLEG15-JPY-04|
#----------------------------------------------------------------------------------------
Scenario:I verify account group details in form
  And I verify account group have "${data[Account Group Type]}" "${data[Account Group Code]}" "${data[Email]}" "${data[Group]}" "${data[Currency]}" "${data[IDEL Limit]}" "${data[Pool Balance Type]}" "${data[Account Group Name]}" "${data[Address]}" "${data[Description]}" "${data[Bank Legal Entity]}" "${data[FX Rate Type]}" "${data[accounts]}" for each data record
  And I scroll to top of page
  And I click accountGroupPage


@StepDef
#----------------------------------------------------------------------------------------
#Step to navigate to account group page from pool edit page
#Example:And I navigate to account group page
#----------------------------------------------------------------------------------------
Scenario:I navigate to account group page
  Given notPresentOnAccountGroupPage is defined by javascript "(function(){return $('span b:contains("Account Groups")').length!=1})()"
  And I scroll to top of page
  And I click accountGroupPage if notPresentOnAccountGroupPage
  And I wait for page to load


@StepDef
#----------------------------------------------------------------------------------------
#Step to verify pool
#Example:And I verify account group have "TEST12123456" "Pool" "TEST121234" "QaAutomation@smartstream-stp.com " "Default Group" "INR" "100000" "Only Short" "NOSTRO" ""''" "Address7" "Description1" "PFCLEG16" "Bid Offer Rate" "''" "PFCLEG15-JPY-04" "PFCLEG15-JPY-03"
#----------------------------------------------------------------------------------------
Scenario:I verify account group have "<Account Group Type>" "<Account Group Code>" "<Email>" "<Group>" "<Currency>" "<IDEL Limit>" "<Pool Balance Type>" "<Account Group Name>" "<Address>" "<Description>" "<Bank Legal Entity>" "<FX Rate Type>" "<addedAccounts>"
  And I verify text for "Account Group Type" is "$<Account Group Type>" for account group
  And accountGroupCodeUppercase is defined by javascript "(function() {return "$<Account Group Code>".toUpperCase()})();"
  ##WA##As account code will populated in UPPERCASE only
  And I verify text for "Account Group Code" is "${accountGroupCodeUppercase}" for account group
  And I verify text for "Email" is "$<Email>" for account group
  And I verify text for "Group" is "$<Group>" for account group
  And I verify text for "Currency" is "$<Currency>" for account group
  And I verify text for "IDEL Limit" is "$<IDEL Limit>" for account group
  And I verify text for "Pool Balance Type" is "$<Pool Balance Type>" for account group
  And I verify text for "Account Group Name" is "$<Account Group Name>" for account group
  And I verify text for "Address" is "$<Address>" for account group
  And I verify text for "Description" is "$<Description>" for account group
  And I verify text for "Bank Legal Entity" is "$<Bank Legal Entity>" for account group
  And I verify text for "FX Rate Type" is "$<FX Rate Type>" for account group
  And addedAccountAre is "$<addedAccounts>"
  And value is present is defined by javascript "(function() {return "$<addedAccounts>" != "''"})();"
  And I select "${selectaccount}" in accounts selected for each selectaccount in addedAccountAre delimited by ";" if value is present

@StepDef
#----------------------------------------------------------------------------------------
#Step to verify text of any particular field
#Example:And I verify text for "Email Address" is "abd@gmail.com" for account group
#----------------------------------------------------------------------------------------
Scenario:I verify text for "<fieldName>" is "<valueIs>" for account group
  And value is present is defined by javascript "(function() {return "$<valueIs>" != "''"})();"
  And textfield is defined by javascript ""$<fieldName>".toLowerCase().replace(/ /g,'-')" if value is present
  And fieldIs can be located by javascript "$('label[for="${textfield}"]').next()" if value is present
  And fieldIs should be "$<valueIs>" if value is present

  @StepDef
  #--------------------------------------------------------------------------------------
  #Step to verify open created account group form, it clicks create account group button and verifies form opened or not
  #Example: And I open create account group form
  #--------------------------------------------------------------------------------------
  Scenario:I open create account group form
    And notOnAccGrpPage is defined by javascript "(function(){ return $('div.btn:contains("Create New")').length==0})()"
    And I scroll to the bottom of accountGroupPage if notOnAccGrpPage
    And I click accountGroupPage if notOnAccGrpPage
    And I click createAccountGroup
    And header should be "Create Account Group"

  @StepDef
  #---------------------------------------------
  #Step to close create account group form
  #Example:And I close create account group form
  #---------------------------------------------
  Scenario:I close create account group form
    And I scroll to top of page
    And I scroll to the bottom of account group form cancelButton
    And I click account group form cancelButton
    And heading should be "Account Groups"

  @StepDef
  @DataTable(header="top")
  #----------------------------------------------------------------------------------------
  #Step to Create account group
  #Example:And I create account group
  ##  |testcaseNo|Account Group Type|Account Group Code|Email|Group|Currency|IDEL Limit|Pool Balance Type|Pool Type|Account Group Name|Address|Description|Bank Legal Entity|FX Rate Type|accounts|
  ##  |TC007|Pool|TEST12234|QaAutomation@smartstream-stp.com|Default Group|INR|100000|Only Short|NOSTRO|TEST12223456|Address6|Description1|PFCLEG16|Bid Offer Rate|PFCLEG15-JPY-03|
  #----------------------------------------------------------------------------------------
  Scenario:I create account group
   And I create account group with "${data[testcaseNo]}" "${data[Account Group Type]}" "${data[Account Group Code]}" "${data[Email]}" "${data[Group]}" "${data[Currency]}" "${data[IDEL Limit]}" "${data[Pool Balance Type]}" "${data[Pool Type]}" "${data[Account Group Name]}" "${data[Address]}" "${data[Description]}" "${data[Bank Legal Entity]}" "${data[FX Rate Type]}" "${data[accounts]}" for each data record

 @StepDef
 #----------------------------------------------------------------------------------------
 #Step to create pool with given parameters
 #Example:And I create account group with "TEST12123456" "Pool" "TEST121234" "QaAutomation@smartstream-stp.com " "Default Group" "INR" "100000" "Only Short" "NOSTRO" ""''" "Address7" "Description1" "PFCLEG16" "Bid Offer Rate" "''" "PFCLEG15-JPY-04" "PFCLEG15-JPY-03"
 #----------------------------------------------------------------------------------------
 Scenario:I create account group with "<testcaseNo>" "<Account Group Type>" "<Account Group Code>" "<Email>" "<Group>" "<Currency>" "<IDEL Limit>" "<Pool Balance Type>" "<Pool Type>" "<Account Group Name>" "<Address>" "<Description>" "<Bank Legal Entity>" "<FX Rate Type>" "<accounts>"
   And I open create account group form
   And I select "$<Account Group Type>" from "Account Group Type" in account group form
   And I select "$<Pool Type>" from "Pool Type" in account group form
   And I add "$<Account Group Code>" in "Account Group Code" for account group form
   And I add "$<Email>" in "Email" for account group form
   And I select "$<Group>" from "Group" in account group form
   And I select "$<Currency>" from "Currency" in account group form
   And I add "$<IDEL Limit>" in "IDEL Limit" for account group form
   And I select "$<Pool Balance Type>" from "Pool Balance Type" in account group form
   And I add "$<Account Group Name>" in "Account Group Name" for account group form
   And I add "$<Address>" in "Address" for account group form
   And I add "$<Description>" in "Description" for account group form
   And I select "$<Bank Legal Entity>" from "Bank Legal Entity" in account group form
   And I select "$<FX Rate Type>" from "FX Rate Type" in account group form
   And I add accounts "$<accounts>" in account group form
   And I save and confirm account group
   And typeIsPool is defined by javascript "(function() {return "$<Account Group Type>" == "Pool"})()"
   And I navigate to home page
   And I go to the account group page
   And I verify status of group "Name:$<Account Group Name>" is "PENDING_APPROVAL" if typeIsPool
   And I wait 2 seconds
   And I navigate to page of account group "$<Account Group Name>"
   And I verify approve group button not Present
   And I verify deactivation button not Present
   #And submitForDeactivation should be displayed
   And I verify account group have "$<Account Group Type>" "$<Account Group Code>" "$<Email>" "$<Group>" "$<Currency>" "$<IDEL Limit>" "$<Pool Balance Type>" "$<Account Group Name>" "$<Address>" "$<Description>" "$<Bank Legal Entity>" "$<FX Rate Type>" "$<accounts>"
   And I scroll to top of page
   And I click accountGroupPage
   And I wait 2 seconds

 @StepDef
 #-----------------------------------------------------
 #Step to select account group type from form
 #Example:And I select "Fund" from "Account Group Type" in account group form
 #-----------------------------------------------------
 Scenario: I select "<valueIs>" from "<selector>" in account group form
   And value is present is defined by javascript "(function() {return "$<valueIs>" != "''"})();"
   And selectfield is defined by javascript ""$<selector>".toLowerCase().replace(/ /g,'-')" if value is present
   And selectfieldIs can be located by javascript "$('#${selectfield}')" if value is present
   And I select "$<valueIs>" in selectfieldIs if value is present

 @StepDef
 #-----------------------------------------------------
 #-----------------------------------------------------
 Scenario: I add "<valueIs>" in "<selector>" for account group form
   And value is present is defined by javascript "(function() {return "$<valueIs>" != "''"})();"
   And addfield is defined by javascript ""$<selector>".toLowerCase().replace(/ /g,'-')" if value is present
   And inputfieldIs can be located by javascript "$('#${addfield}')" if value is present
   And I type "$<valueIs>" in inputfieldIs if value is present

 @StepDef
 #-----------------------------------------------------
 #-----------------------------------------------------
 Scenario:I add accounts "<accounts>" in account group form
  And accountIs is "$<accounts>"
  And value is present is defined by javascript "(function() {return "$<accounts>" != "''"})();"
  And I select "${selectaccount}" in accounts available for each selectaccount in accountIs delimited by ";" if value is present
  And I click add button if value is present

  @StepDef
  #-----------------------------------------------------
  #-----------------------------------------------------
  Scenario:I remove accounts "<accounts>" in account group form
   And accountToRemove is "$<accounts>"
   And value is present is defined by javascript "(function() {return "$<accounts>" != "''"})();"
   And I select "${selectaccount}" in accounts selected for each selectaccount in accountToRemove delimited by ";" if value is present
   And I click remove button if value is present


@StepDef
#-----------------------------------------------------
#Step to verify under legal entity user can see all the active legal entity from cms
#Example:And I verify currency in account group form
#-----------------------------------------------------
Scenario: I verify currency in account group form
  And currencyList is defined by sql "select listagg(NAME,',') within group (order by NAME) FROM (select distinct NAME from cms_ref_currency_param)" in the ${dbName} database
  And I select currency "${currency}" in account group form for each currency in currencyList delimited by ","

@StepDef
#-----------------------------------------------------
#Step to verify and select under legal entity user can see all the active legal entity from cms
#Example:And I select currency "INR" in account group form
#-----------------------------------------------------
Scenario: I select currency "<currency>" in account group form
  And currencyPresent is defined by javascript "(function() {return "$<currency>" != "Unknown Currency"})();"
  And I select "$<currency>" in currency selector if currencyPresent

@StepDef
#-----------------------------------------------------
#Step to verify under legal entity user can see all the active legal entity from cms
#Example:And I verify legal entity in account group form
#-----------------------------------------------------
Scenario: I verify legal entity in account group form
  And legalentityList is defined by sql "select listagg(NAME,',') within group (order by NAME) FROM (select distinct NAME from cms_ref_legal_entity_param)" in the ${dbName} database
  And I select legalentity "${legalentity}" for each legalentity in legalentityList delimited by ","

@StepDef
#-----------------------------------------------------
#Step to verify and select under legal entity user can see all the active legal entity from cms
#Example:And I select legalentity "abc" in account group form
#-----------------------------------------------------
Scenario: I select legalentity "<legalentity>" in account group form
  And legalentityPresent is defined by javascript "(function() {return "$<legalentity>" != "UNKN"})();"
  And I select "$<legalentity>" in legalEntity selector if legalentityPresent

@StepDef
#-----------------------------------------------------
#Step to test fx rate selector on pool form
#Example:And I verify user can select "Mid Rate;Bid Offer Rate" fx rate type
#-----------------------------------------------------
Scenario: I verify user can select "<typeIs>" fx rate type
  And typeList is "$<typeIs>"
  And I select "${type}" in fxRateType selector for each type in typeList delimited by ";"

@StepDef
#-----------------------------------------------------
#Step to test pool type selector on pool form
#Example:And I verify user can select "NOSTRO;VOSTRO;RTGS" pool type
#-----------------------------------------------------
Scenario: I verify user can select "<typeIs>" pool type
  And typeList is "$<typeIs>"
  And I select "${type}" in poolType selector for each type in typeList delimited by ";"

@StepDef
#-----------------------------------------------------
#Step to test pool balance type selector on pool form
#Example:And I verify user can select "Full;Only Short;Liquid Currency Balance" pool balance type
#-----------------------------------------------------
Scenario: I verify user can select "<typeIs>" pool balance type
  And typeList is "$<typeIs>"
  And I select "${type}" in poolBalanceType selector for each type in typeList delimited by ";"


@StepDef
@DataTable(header="top")
#----------------------------------------------------------------------------------------
#Step to verify mandatory fields on account group form
#Example:And I verify mandatory field
##    |fieldName|
##    |Account Group Type|
#----------------------------------------------------------------------------------------
Scenario:I verify mandatory field
And I verify "${data[fieldName]}" is mandatory for each data record


@StepDef
#-----------------------------------------------------
#Step to verify mandatory fields on account group form
#Example:And I verify mandatory field
##    |fieldName|
##    |Account Group Type|
#-----------------------------------------------------
Scenario: I verify "<fieldIs>" is mandatory
And field is defined by javascript ""$<fieldIs>".toLowerCase().replace(/ /g,'-')"
And isMandatory is defined by javascript "$('label[for="${field}"]').hasClass("stl-account-group-form-required-field")"
And isMandatory should be "true"


@StepDef
#-----------------------------------------------------
#Step to verify fields are not editable on edit account group form
#Example:And I verify "Pool Type" is not editable
#-----------------------------------------------------
 Scenario: I verify "<fieldIs>" is not editable
    And field is defined by javascript ""$<fieldIs>".toLowerCase().replace(/ /g,'-')"
    And notEditable is defined by javascript "(function(){ return $('label[for="${field}"]').next("input").length})()"
    And notEditable should be "0"

@StepDef
@DataTable(header="top")
#########################################################################################
#----------------------------------------------------------------------------------------
#Step to verify system does not allow to create a Pool if mandatory fields set to blank
#Example:And I verify system does not allow to create a Pool when mandatory fields set to blank
##      |Account Group Type|Account Group Code|Email|Group|Currency|IDEL Limit|Pool Balance Type|Pool Type|Account Group Name|Address|Description|Bank Legal Entity|FX Rate Type|accounts|verifyFor|
##      |Pool|''|QaAutomation@smartstream-stp.com|Default Group|INR|100000|Only Short|NOSTRO|AUTOTEST1212345|Address6|Description1|PFCLEG16|Bid Offer Rate|PFCLEG15-HKD-02|Code|
#----------------------------------------------------------------------------------------
Scenario:I verify system does not allow to create a Pool when mandatory fields set to blank
And I verify system does not allow to create a Pool with "${data[Account Group Type]}" "${data[Account Group Code]}" "${data[Email]}" "${data[Group]}" "${data[Currency]}" "${data[IDEL Limit]}" "${data[Pool Balance Type]}" "${data[Pool Type]}" "${data[Account Group Name]}" "${data[Address]}" "${data[Description]}" "${data[Bank Legal Entity]}" "${data[FX Rate Type]}" "${data[accounts]}" "${data[verifyFor]}" for each data record

@StepDef
#-----------------------------------------------------
#Step to verify system does not allow to create a Pool if mandatory fields set to blank
#Exaple:And  I verify can not create pool with duplicate pool code "Pool" "AUTOTEST1212342" "QaAutomation@smartstream-stp.com" "Default Group" "INR" "100000" "Only Short" "NOSTRO" "testduplicate" "Address6" "Description1" "PFCLEG16" "Bid Offer Rate" "PFCLEG15-NZD-03"
#-----------------------------------------------------
Scenario:I verify system does not allow to create a Pool with "<Account Group Type>" "<Account Group Code>" "<Email>" "<Group>" "<Currency>" "<IDEL Limit>" "<Pool Balance Type>" "<Pool Type>" "<Account Group Name>" "<Address>" "<Description>" "<Bank Legal Entity>" "<FX Rate Type>" "<accounts>" "<verifyFor>"
  And I open create account group form
  And I verify create account group with "$<Account Group Type>" "$<Account Group Code>" "$<Email>" "$<Group>" "$<Currency>" "$<IDEL Limit>" "$<Pool Balance Type>" "$<Pool Type>" "$<Account Group Name>" "$<Address>" "$<Description>" "$<Bank Legal Entity>" "$<FX Rate Type>" "$<accounts>"
  And errorMsg should be "$<verifyFor> is required."
  And invalidColorCode is defined by javascript "(function(){return $('form .ng-invalid').css('border-color')==="rgb(221, 80, 74)"})()"
  And invalidColorCode should be "true"
  And I click account group form cancelButton

  @StepDef
  #-----------------------------------------------------
  #-----------------------------------------------------
  Scenario:I verify create account group with "<Account Group Type>" "<Account Group Code>" "<Email>" "<Group>" "<Currency>" "<IDEL Limit>" "<Pool Balance Type>" "<Pool Type>" "<Account Group Name>" "<Address>" "<Description>" "<Bank Legal Entity>" "<FX Rate Type>" "<accounts>"
    And I select "$<Account Group Type>" from "Account Group Type" in account group form
    And I select "$<Pool Type>" from "Pool Type" in account group form
    And I add "$<Account Group Code>" in "Account Group Code" for account group form
    And I add "$<Email>" in "Email" for account group form
    And I select "$<Group>" from "Group" in account group form
    And I select "$<Currency>" from "Currency" in account group form
    And I add "$<IDEL Limit>" in "IDEL Limit" for account group form
    And I select "$<Pool Balance Type>" from "Pool Balance Type" in account group form
    And I add "$<Account Group Name>" in "Account Group Name" for account group form
    And I add "$<Address>" in "Address" for account group form
    And I add "$<Description>" in "Description" for account group form
    And I select "$<Bank Legal Entity>" from "Bank Legal Entity" in account group form
    And I select "$<FX Rate Type>" from "FX Rate Type" in account group form
    And I add accounts "$<accounts>" in account group form
    And I save and confirm account group

@StepDef
#-----------------------------------------------------
#Step to verify system only shows all "nostro/vastro/rtgs" the accounts that are not assigned to any pool
#Example:And I verify system only shows all "NOSTRO" the accounts having bank legalEntity "SCCLEG01" that are not assigned to any pool
#-----------------------------------------------------
Scenario: I verify system only shows all "<accType>" the accounts having bank legalEntity "<legalEntity>" that are not assigned to any pool
And accTypeIs is defined by javascript
    """
    (function(){
        var result="";
        if("$<accType>"=="NOSTRO"){
          result="1";
        }else if("$<accType>"=="VOSTRO"){
            result="2";
        }else if("$<accType>"=="RTGS"){
          result="3";
        }
        return result;
    })()
    """
  And I verify user can select "$<accType>" pool type
  And I select "$<legalEntity>" from "Bank Legal Entity" in account group form
  And accountsList is defined by sql "select listagg(NAME,',') within group (order by NAME) FROM (select name from cms_ref_Account_param where account_id not in (select account_id from cms_ref_fund_account) and ACC_TYPE = ${accTypeIs} and active_status=1 and name NOT LIKE '%Unknown%' and extra_ref4='$<legalEntity>')" in the ${dbName} database
  And I add accounts "${accounts}" in account group form for each accounts in accountsList delimited by ","

@StepDef
#-----------------------------------------------------
#Step to verify can not edit by keeping mandatory fields blank
#Example:And I verify can not edit by keeping "Currency,FX Rate Type,Bank Legal Entity,Pool Balance Type" blank
#-----------------------------------------------------
 Scenario: I verify can not edit by keeping "<types>" blank
   And I select "" in currency selector
   And I select "" in poolBalanceType selector
   And I select "" in fxRateType selector
   And I scroll to the bottom of saveButton
   And I save and cancel account group
   And fieldsAre is "$<types>"
   And I verify errorMsg for "${errorfieldIs}" for each errorfieldIs in fieldsAre delimited by ","

@StepDef
#-----------------------------------------------------
#Step to verify can not edit by keeping mandatory fields blank
#Example:And I verify errorMsg for "Currency" is required
#-----------------------------------------------------
  Scenario:I verify errorMsg for "<fieldIs>"
   And field is defined by javascript ""$<fieldIs>".toLowerCase().replace(/ /g,'-')"
   And errorMsgIs can be located by javascript "$('label[for="${field}"]').next().find('p')"
   And errorMsgIs should be "$<fieldIs> is required."

@StepDef
#-----------------------------------------------------
#Step to verify can not edit by keeeping account blank
#Example:I verify can not edit by keeeping account blank
#-----------------------------------------------------
  Scenario:I verify can not edit by keeeping account blank
    And I click removeAll button
    And noAccountSelectedMsgDialog should be "${noAccountSelectedMsg}"


@StepDef
#-----------------------------------------------------
#Step to verify account filter on edit/create pool form
#Example: And I verify account by Currency "HKD"
#-----------------------------------------------------
 Scenario:I verify account by <Code> "<codeIs>"
    And field can be located by javascript "$('h2:contains("Accounts Included")').parent().find('label:contains("$<Code>")').next()"
    And inputSearch is present is defined by javascript "(function() {return "$<Code>" == "Code" || "$<Code>" == "Name"})();"
    And selectSearch is present is defined by javascript "(function() {return "$<Code>" != "Code" && "$<Code>" != "Name"})();"
    And I enter "$<codeIs>" in field if inputSearch is present
    And I select "$<codeIs>" in field if selectSearch is present
    And legalEntity is defined by javascript "(function() {return "$<Code>" == "Legal Entity"})();"
    And NotlegalEntity is defined by javascript "(function() {return "$<Code>" != "Legal Entity"})();"
    And I verify account "$<codeIs>" is present if NotlegalEntity
    And accountsList is defined by sql "select listagg(NAME,',') within group (order by NAME) FROM (select name from cms_ref_Account_param where account_id not in (select account_id from cms_ref_fund_account) and extra_ref4 = '$<codeIs>')" in the ${dbName} database if legalEntity
    And I select "${accounts}" in accounts available for each accounts in accountsList delimited by "," if legalEntity
    And I clear field if inputSearch is present
    And I type "a" in field if inputSearch is present
    And I wait 3 seconds if inputSearch is present
    And I send "BACK_SPACE" to field if inputSearch is present
    And I select "" in field if selectSearch is present

@StepDef
#-----------------------------------------------------
#Step to verify account filter on edit/create pool form with multiple filters
#Example:And I search account by Currency "HKD" and Legal Entity "PFCLEG17"
#-----------------------------------------------------
 Scenario: I search account by <criteria1> "<searchBy1>" and <criteria2> "<searchBy2>"
   And field1 can be located by javascript "$('h2:contains("Accounts Included")').parent().find('label:contains("$<criteria1>")').next()"
   And field2 can be located by javascript "$('h2:contains("Accounts Included")').parent().find('label:contains("$<criteria2>")').next()"
   And I select "$<searchBy1>" in field1
   And I select "$<searchBy2>" in field2
   And I verify account "$<searchBy1>" is present
   And I verify accounts sorted alphabetically

@StepDef
#-----------------------------------------------------
#Step to verify account filter on edit/create pool form with multiple filters
#Example:And I verify account "PFCLEG17" is present
#-----------------------------------------------------
   Scenario: I verify account "<Account>" is present
   And resultIs is defined by javascript "(function(){var result =true; $('p:contains("ACCOUNTS AVAILABLE")').parent().siblings('select').find('option').each(function(){result=$(this).text().includes("$<Account>")&&result}); return result})()"
   And resultIs should be "true"

 @StepDef
 #-----------------------------------------------------
 #-----------------------------------------------------
 Scenario: I verify accounts sorted alphabetically
  And sortResult is defined by javascript
    """
    (function(){
    	   a="";result="";
    	   $('p:contains("ACCOUNTS AVAILABLE")').parent().siblings('select').find('option').each(function(){
            if(($(this).text().trim()) > a){
    			     result="Done";a=$(this).text().trim()
    		    }
            else{result="";return result;}
          });
    		return result;
    })()
    """
    And sortResult should be "Done"

  @StepDef
  #-----------------------------------------------------
  #Step to verify account filter on edit/create pool form
  #Example: And I verify gets empty result when search criteria not matches on searching with Legal Entity "PFCLEG16"
  #-----------------------------------------------------
   Scenario: I verify gets empty result when search criteria not matches on searching with <criteria> "<searchBy>"
   And field can be located by javascript "$('h2:contains("Accounts Included")').parent().find('label:contains("$<criteria>")').next()"
   And inputSearch is present is defined by javascript "(function() {return "$<criteria>" == "Code" || "$<criteria>" == "Name"})();"
   And selectSearch is present is defined by javascript "(function() {return "$<criteria>" != "Code" && "$<criteria>" != "Name"})();"
   And I enter "$<searchBy>" in field if inputSearch is present
   And I select "$<searchBy>" in field if selectSearch is present
   And optionCount is defined by javascript "$('p:contains("ACCOUNTS AVAILABLE")').parent().siblings('select').find('option').length"
   And optionCount should be "0"
   And I navigate to account group page

 @StepDef
 @DataTable(header="top")
 #-----------------------------------------------------
 #Step to check audit i.e. version history
 #Exaple:And I audit account group
 #|Account Group Type|Account Group Code|Email Address                    |Group        |Currency|IDEL Limit|Pool Balance Type|Account Group Name|Address      |Description|Bank Legal Entity|FX Rate Type|accounts|
 #|FUND              |HODHTDFND1        | QaAutomation@smartstream-stp.com|Default Group|        |          |                 |JIRA HODHTDFND1   |Address Added|           |                 |            |HODACC1,HTDACC1|
 #-----------------------------------------------------
 Scenario: I audit account group
  And I audit account group details "${data[Account Group Type]}" "${data[Account Group Code]}" "${data[Email Address]}" "${data[Group]}" "${data[Currency]}" "${data[IDEL Limit]}" "${data[Pool Balance Type]}" "${data[Account Group Name]}" "${data[Address]}" "${data[Description]}" "${data[Bank Legal Entity]}" "${data[FX Rate Type]}" "${data[accounts]}" for each data record

@StepDef
#-----------------------------------------------------
#Step to check audit i.e. version history
#-----------------------------------------------------
Scenario:I audit account group details "<Account Group Type>" "<Account Group Code>" "<Email Address>" "<Group>" "<Currency>" "<IDEL Limit>" "<Pool Balance Type>" "<Account Group Name>" "<Address>" "<Description>" "<Bank Legal Entity>" "<FX Rate Type>" "<addedAccounts>"
 And I scroll to bottom of page
 And auditMatch is defined by javascript
 """
 (function getResult(){
     var result;
	 var filedArray=["Account Group Type","Code","Email Address","Group","Currency","IDEL Limit","Pool Balance Type","Name","Address","Description","Bank Legal Entity","FX Rate Type","Accounts"];
	 var valuesToMatch=["$<Account Group Type>","$<Account Group Code>","$<Email Address>","$<Group>","$<Currency>","$<IDEL Limit>","$<Pool Balance Type>","$<Account Group Name>","$<Address>","$<Description>","$<Bank Legal Entity>","$<FX Rate Type>","$<addedAccounts>"];
	 function getColId(forField){
		var colId;
		 $('.ag-header-container .ag-header-cell span.ag-header-cell-text').filter(function()
		 {
			//console.log($(this).text().trim());
			if($(this).text().trim()==forField)
			{
			$(this).parents().filter(function()
				{
				if($(this).attr('col-id')!=null)
					{
						colId=$(this).attr('col-id')
					}
				}
			)}
		});
		return colId;
	}
	function checkValueMatches(forFiled,value,row){
		console.log("In function checkMatch():"+forFiled+":"+value);
		var matchFound=false;
		var colId=getColId(forFiled);
		console.log("colId:"+colId+" text:"+row.find("div[col-id*='"+colId+"']").text().trim());
		if(row.find("div[col-id*='"+colId+"']").text().trim() == value || value == "" || value == "''")
			matchFound=true;
		console.log("Match:"+matchFound);
		return matchFound;

	}
    $('.ag-body-viewport [role="row"]').each(function(){
			for(var i=0;i<filedArray.length;i++){
				if(checkValueMatches(filedArray[i],valuesToMatch[i],$(this))){
					result=true;
				}else{
					result=false;
					break;
				}
			}
			if(result==true)
				return true;
   })
     return result;
   })()
 """
 And auditMatch should be "true"


@StepDef
#-----------------------------------------------------
#Step to verify status of pool
#Story ID:CMS-10168
#TC Mapping:PoolUI-81,89
#Example:And I verify status of group "test1234" is "PENDING FOR APPROVAL"
#-----------------------------------------------------
Scenario:I verify status of group "<groupName>" is "<statusIs>"
  And I apply account group filter "$<groupName>"
  And statusResult is defined by javascript "(function(){var result =true;if($('stl-account-group-grid [class*="ag-body-container"] [col-id*="approvalStatus"]').length=="0"){result=false}else{$('stl-account-group-grid [class*="ag-body-container"] [col-id*="approvalStatus"]').each(function(){console.log($(this).text());result=$(this).text().includes("$<statusIs>")&&result})}; return result})()"
  And statusResult should be "true"
  And statusIcon is defined by javascript
    """
    (function(){var result =true;if($('stl-account-group-grid [class*="ag-body-container"] [col-id*="history"]').length=="0"){result=false}else{$('stl-account-group-grid [class*="ag-body-container"] [col-id*="history"]')
	.each(function(){
		if("$<statusIs>"=="APPROVED") {

			console.log($(this).find('stl-icon').css('color'));result=($(this).find('stl-icon').css('color')=="rgb(97, 172, 9)")&&result
		}
		else if ( "$<statusIs>"=="PENDING_APPROVAL") {
						console.log($(this).find('stl-icon').css('color'));result=($(this).find('stl-icon').css('color')=="rgb(247, 156, 29)")&&result

		}});}
		return result})()
    """
  And statusIcon should be "true"
  And I click first row of accountGroupGrid
  And statusMessage is defined by javascript ""$<statusIs>".replace(/_/g,' ').replace("SUBMITTED FOR","PENDING")"
  And statusChipMessage text should be "${statusMessage}" 
  And statusChipIconColor is defined by javascript 
  """
    (function (){
        var elem = document.querySelector('tlmv-chip div');
        var colorMatchedStatus = "unmatched";
        var color = window.getComputedStyle(elem, null).getPropertyValue("background-color");
        if("$<statusIs>"=="APPROVED" && color == "${greenColor}"){
        	colorMatchedStatus = "matched";
        }
        else if("$<statusIs>"=="PENDING_APPROVAL" && color == "${orangeColor}"){
        	colorMatchedStatus = "matched";
        }
        else if("$<statusIs>"=="SUBMITTED_FOR_DEACTIVATION" && color == "${lightOrangeColor}"){
        	colorMatchedStatus = "matched";
        }
        else if("$<statusIs>"=="DEACTIVATED" && color == "${greyColor}"){
        	colorMatchedStatus = "matched";
        }
        return colorMatchedStatus;
        })()
  """
  And statusChipIconColor should be "matched"
  And I navigate to account group page


@StepDef
#-----------------------------------------------------
#Step to verify approval pool
#Story ID:CMS-10168,CMS-19184
#TC Mapping:PoolUI-84,86,DeactivationPool-17
#Example:And I verify approve group button not Present
#-----------------------------------------------------
Scenario:I approve account group "<Account Group Name>"
  And I navigate to page of account group "$<Account Group Name>"
  And I click approveButton
  And I verify approve group button not Present
  ##NA##And submitForDeactivation should be displayed
  And I wait 3 seconds
  And I navigate to account group page
  And I verify status of group "Name:$<Account Group Name>" is "APPROVED"

@StepDef
#-----------------------------------------------------
#Step to verify approval button not present
#Story ID:CMS-10168
#TC Mapping:PoolUI-84,86
#Example:And I verify approve group button not Present
#-----------------------------------------------------
Scenario:I verify approve group button not Present
  And approvebuttonNotPresent is defined by javascript "(function(){return $('div.btn:contains("Approve")').length==0})()"
  And approvebuttonNotPresent should be "true"


@StepDef
#-----------------------------------------------------
#Step to verify static data editor can submit the Pool for deactivation
#Story ID:CMS-10184
#TC Mapping:DeactivationPool-1
#Example:And I submit pool "pool11" for deactivation and audit it "TC009"
#-----------------------------------------------------
Scenario:I submit pool "<poolName>" for deactivation and audit to verify "<testcase>"
  And I navigate to page of account group "$<poolName>"
  And I verify deactivation button not Present
  And I click submitForDeactivation
  And deactivateConfirmationDialog should be displayed
  And deactivateConfirmationDialogMsg should be "Deactivating the Pool will dis-associate all the Accounts from Pool. Do you wish to proceed?"
  And I click yesButton
  And I navigate to account group page
  And I verify status of group "Name:$<poolName>" is "SUBMITTED_FOR_DEACTIVATION"
  And I navigate to page of account group "$<poolName>"
  And I verify deactivation button not Present
  And I verify submit for deactivation button not Present
  And I verify account group dashboard history csv for "$<testcase>"

@StepDef
#-----------------------------------------------------
#Step to verify deactivation button not Present
#Story ID:CMS-10184
#TC Mapping:DeactivationPool-26
#Example:And I verify deactivation button not Present
#-----------------------------------------------------
Scenario:I verify deactivation button not Present
  And deactivationNotPresent is defined by javascript "(function(){return $('stl-account-group-prompt-dialog h4:contains("Approve Deactivation")').length==0})()"
  And deactivationNotPresent should be "true"


@StepDef
#-----------------------------------------------------
#Step to verify submit for deactivation button not Present
#Story ID:CMS-10184
#TC Mapping:DeactivationPool-11
#Example:And I verify submit for deactivation button not Present
#-----------------------------------------------------
Scenario:I verify submit for deactivation button not Present
  And deactivationNotPresent is defined by javascript "(function(){return $('stl-account-group-prompt-dialog h4:contains("Submit for Deactivation")').length==0})()"
  And deactivationNotPresent should be "true"


@StepDef
#-----------------------------------------------------
#-----------------------------------------------------
Scenario:I verify no accounts should be populated when pool type is not selected
  And accountSelectorNotPresent is defined by javascript "(function(){return $('p:contains("ACCOUNTS AVAILABLE")').parent().siblings('select').length==0})()"
  And accountSelectorNotPresent should be "true"


@StepDef
#-----------------------------------------------------
#Step to verify can not edit account group with duplicate code
#Story ID:CMS-10342
#TC Mapping:PoolUI TC-68
#Example:And I verify can not edit account group "TEST12123456" with already existing code "Test1234"
#-----------------------------------------------------
Scenario:I verify can not edit account group "<poolName>" with already existing code "<poolCode>"
  Given notPresentOnAccountGroupPage is defined by javascript "(function(){return $('span b:contains("Account Groups")').length!=1})()"
    And I navigate to account group page if notPresentOnAccountGroupPage
    And I open group "$<poolName>" to edit
    And I add "$<poolCode>" in "Account Group Code" for account group form
    And I save and cancel account group
    And formError should be "Another fund with code $<poolCode> already exists"
    And I navigate to account group page



@StepDef
@DataTable(header="top")
#----------------------------------------------------------------------------------------
#Step to verify can not create account group with duplicate code
#Story ID:CMS-10342
#TC Mapping:PoolUI TC-68
#Example:And I verify can not create account group with duplicate code
##  	 |Account Group Type|Account Group Code|Email|Group|Currency|IDEL Limit|Pool Balance Type|Pool Type|Account Group Name|Address|Description|Bank Legal Entity|FX Rate Type|accounts|
##  	 |Pool|AUTOTEST1212342|QaAutomation@smartstream-stp.com|Default Group|INR|100000|Only Short|NOSTRO|testduplicate|Address6|Description1|PFCLEG16|Bid Offer Rate|PFCLEG15-NZD-03|
#----------------------------------------------------------------------------------------
	Scenario: I verify can not create account group with duplicate code
		And  I verify can not create account group with duplicate code "${data[Account Group Type]}" "${data[Account Group Code]}" "${data[Email]}" "${data[Group]}" "${data[Currency]}" "${data[IDEL Limit]}" "${data[Pool Balance Type]}" "${data[Pool Type]}" "${data[Account Group Name]}" "${data[Address]}" "${data[Description]}" "${data[Bank Legal Entity]}" "${data[FX Rate Type]}" "${data[accounts]}" for each data record

@StepDef
#-----------------------------------------------------
#Step to verify can not create account group with duplicate code
#Story ID:CMS-10342
#TC Mapping:PoolUI TC-68
#Example:I verify can not create account group with duplicate code "Pool" "AUTOTEST1212342" "QaAutomation@smartstream-stp.com" "Default Group" "INR" "100000" "Only Short" "NOSTRO" "testduplicate" "Address6" "Description1" "PFCLEG16" "Bid" "Offer Rate" "PFCLEG15-NZD-03"
#-----------------------------------------------------
    Scenario: I verify can not create account group with duplicate code "<Account Group Type>" "<Account Group Code>" "<Email>" "<Group>" "<Currency>" "<IDEL Limit>" "<Pool Balance Type>" "<Pool Type>" "<Account Group Name>" "<Address>" "<Description>" "<Bank Legal Entity>" "<FX Rate Type>" "<accounts>"
     And I open create account group form
     And I select "$<Account Group Type>" from "Account Group Type" in account group form
     And I select "$<Pool Type>" from "Pool Type" in account group form
     And I add "$<Account Group Code>" in "Account Group Code" for account group form
     And I add "$<Email>" in "Email" for account group form
     And I select "$<Group>" from "Group" in account group form
     And I select "$<Currency>" from "Currency" in account group form
     And I add "$<IDEL Limit>" in "IDEL Limit" for account group form
     And I select "$<Pool Balance Type>" from "Pool Balance Type" in account group form
     And I add "$<Account Group Name>" in "Account Group Name" for account group form
     And I add "$<Address>" in "Address" for account group form
     And I add "$<Description>" in "Description" for account group form
     And I select "$<Bank Legal Entity>" from "Bank Legal Entity" in account group form
     And I select "$<FX Rate Type>" from "FX Rate Type" in account group form
     And I add accounts "$<accounts>" in account group form
     And I scroll to the bottom of saveButton
     And I save and cancel account group
     And formError should be "A fund with code $<Account Group Code> already exists"
     And I navigate to account group page


 @StepDef
 #----------------------------------------------------------------------------------------
 #Step to verify can not modify pool Submitted for deactivation
 #Story ID:
 #TC Mapping:
 #Example:And I navigate to account group page
 #----------------------------------------------------------------------------------------
 Scenario:I verify pool "<poolName>" can not be modified
 And editButtonNotPresent is defined by javascript "(function(){return $('div.btn:contains("Edit")').length==0})()"
 And editButtonNotPresent should be "true"


 @StepDef
 #----------------------------------------------------------------------------------------
 #Step to verify deactivation of pool
 #Story ID:CMS-10996
 #TC Mapping:DeactivationPool-25
 #Example:And I deactivate pool "12asd" and audit to verify "tc123"
 #----------------------------------------------------------------------------------------
 Scenario:I deactivate pool "<poolName>" and audit to verify "<testcase>"
  And I navigate to page of account group "$<poolName>"
  And approveDeactivation should be displayed
  And I click approveDeactivation
  And I click yesButton
  And approveDeactivateConfirmationDialog should be displayed
  And deactivationErrorMsgIs should be "Deactivation reason cannot be empty or greater than 255 characters."
  And I type "abcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghij" in deactivationReason
  And deactivationReason should be "abcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcde"
  And I type "deactivationReason" in deactivationReason
  And I click yesButton
  And I verify account group dashboard history csv for "$<testcase>"



@StepDef
#-------------------------------------------------------------
#Step to verify accounts present in pool creation form
#Story ID:CMS-10996
#TC Mapping:PoolUI TC-26
#Example:And I apply account group filter "Account:HDFAUDAC1"
#-------------------------------------------------------------
Scenario:  I verify accounts "<accountNames>" are available for use
    And accountCodeList is "$<accountNames>"
    And I verify account by Code "${accountCode}" for each accountCode in accountCodeList delimited by ";"



  @StepDef
  @DataTable(header="top")
  #----------------------------------------------------------------------------------------
  #Step to Create account group
  #Story ID:CMS-10342,CMS-10168,CMS-10181,CMS-10102, CMS-10107
  #TC Mapping:PoolUI-1,47,48,81,53,54,55,56,2,13,14,15,16,17
  #Example:And I approve account group
  ##  |testcaseNo|Account Group Type|Account Group Code|Email|Group|Currency|IDEL Limit|Pool Balance Type|Pool Type|Account Group Name|Address|Description|Bank Legal Entity|FX Rate Type|accounts|
  ##  |TC007|Pool|TEST12234|QaAutomation@smartstream-stp.com|Default Group|INR|100000|Only Short|NOSTRO|TEST12223456|Address6|Description1|PFCLEG16|Bid Offer Rate|PFCLEG15-JPY-03|
  #----------------------------------------------------------------------------------------
  Scenario:I approve account group
   And I approve account group "${data[Account Group Name]}" for each data record


 @StepDef
 #-----------------------------------------------------
 #Step to verifylegal entity is disabled in serach
 #Story ID:CMS-10132
 #TC Mapping:PoolUI TC-38,39,40,41
 #Example: And I verify legal entity at search tab is disabled
 #-----------------------------------------------------
  Scenario:I verify legal entity at search tab is disabled
     And legalEntityAtSearch can be located by javascript "$('h2:contains("Accounts Included")').parent().find('label:contains("Legal Entity")').next()"
     And legalEntityAtSearch should be disabled


@StepDef
#############################################################
#------------------------------------------------------------
#Step to verify account group with specific name is present in account group dashboard
#Example: And I verify account group "fundABC" is present on dashboard
#------------------------------------------------------------
Scenario: I verify account group "<name>" is present on dashboard
And accountGroupPresent is defined by javascript
 """
  (function(){
      a=[];result="";
        function getData() {
 		 $('.ag-body-viewport [role="row"] [col-id*="name"]').each(function(){
 			console.log($(this).text());
 			if($(this).text().trim()=="$<name>" ) {
                       result = "Done";
 					 a.push($(this).text());
                  }
 		})
 	if(a.length==0) {
 			$('button[ref="btNext"]').click();
 		}
 	else {
           result = "Done"
          }
        }
        getData();
        return result;
      })();
 """
 Then accountGroupPresent should be "Done"

@StepDef
#############################################################
#------------------------------------------------------------
#Step to vget row no for specific name is present in account group dashboard
#Example: And I get row no for account group "fundABC"
#------------------------------------------------------------
Scenario: I get row no for account group "<name>"
And tempVar is defined by javascript
 """
  (function(){
      var result="";
      $('.ag-body-viewport [role="row"]').each(function(){
        if($(this).find("div[col-id*='name']").text().trim()=="$<name>"){
           result = $(this).attr("row-index");
           console.log("Row index: "+result)
          return false;
        }
     })
       return result;
    })()
 """
 And rowNoForAccountGroup is "${tempVar}"


 @StepDef
 ############################################################
 #-----------------------------------------------------------
 #Step verify each parameter of account group on dashboard
 #Example:And I verify for account group "FundAbc" Code is "Code12345"
 #-----------------------------------------------------------
 Scenario:I verify for account group "<name>" <property> is "<data>"
  And dataIsPresent is defined by javascript "(function(){return ("$<data>"!="''" && "$<data>"!="")})()"
  And I get row no for account group "$<name>" if dataIsPresent
  And I scroll to account group ladder column "$<property>" if dataIsPresent
  And result is defined by javascript
   """
   (function getResult(){
     var result,colId;
     $('.ag-header-container .ag-header-cell span.ag-header-cell-text').filter(function()
     {
    	if($(this).text().trim()=="$<property>")
    	{
    	$(this).parents().filter(function()
    		{
    		if($(this).attr('col-id')!=null)
    			{
    				colId=$(this).attr('col-id')
    			}
    		}
    	)}
    })
    console.log("Data is: "+"$<data>");
    console.log("Data got: "+$('.ag-body-viewport [row-index="${rowNoForAccountGroup}"] div[col-id*="'+colId+'"]').text().trim());
    if($('.ag-body-viewport [row-index="${rowNoForAccountGroup}"] div[col-id*="'+colId+'"]').text().trim() == "$<data>")
         result = "Done";
     return result;
   })()
   """
   And result should be "Done" if dataIsPresent
   And I scroll to first column of account group ladder

 @StepDef
 @DataTable(header="top")
 ###########################################################################################################
 #----------------------------------------------------------------------------------------------------------
 #Step to verify account group
 #Example:
 #And I verify account group details on dashboard
 #    |Account Group Type|Account Group Code|Email Address|Group|Currency|IDEL Limit|Pool Balance Type|Pool Type| Account GroupName|Address|Description|Bank Legal Entity|FX Rate Type|Accounts|
 #    |Pool|TEST12234|QaAutomation@smartstream-stp.com|Default Group|INR|100000|Only Short|NOSTRO|TEST12223456|Address6|Description1|PFCLEG16|Bid Offer Rate|PFCLEG15-JPY-03|
 #----------------------------------------------------------------------------------------------------------
 Scenario: I verify account group details on dashboard
   And I verify account group with "${data[Account Group Type]}" "${data[Account Group Code]}" "${data[Email Address]}" "${data[Group]}" "${data[Currency]}" "${data[IDEL Limit]}" "${data[Pool Balance Type]}" "${data[Pool Type]}" "${data[Account Group Name]}" "${data[Address]}" "${data[Description]}" "${data[Bank Legal Entity]}" "${data[FX Rate Type]}" "${data[Accounts]}" is present for each data record


@StepDef
############################################################
#-----------------------------------------------------------
#Step verify each parameter of account group on dashboard
#Example:And I verify account group with "<accountGroupType>" "<accountGroupcode>" "<Email Address>" "<group>" "<currency>" "<IDELLimit>" "<poolBalanceType>" "<poolType>" "<accountGroupName>" "<address>" "<description>" "<bankLegalEntity>" "<fXRateType>" "<accounts>" is present
#-----------------------------------------------------------
Scenario:I verify account group with "<accountGroupType>" "<accountGroupcode>" "<Email Address>" "<group>" "<currency>" "<IDELLimit>" "<poolBalanceType>" "<poolType>" "<accountGroupName>" "<address>" "<description>" "<bankLegalEntity>" "<fXRateType>" "<accounts>" is present
  And I enter accounts group filter "Name:$<accountGroupName>"
  And I verify account group "$<accountGroupName>" is present on dashboard
  And I verify for account group "$<accountGroupName>" Account Group Type is "$<accountGroupType>"
  And I verify for account group "$<accountGroupName>" Code is "$<accountGroupcode>"
  And I verify for account group "$<accountGroupName>" Email Address is "$<Email Address>"
  And I verify for account group "$<accountGroupName>" Group is "$<group>"
  And I verify for account group "$<accountGroupName>" Currency is "$<currency>"
  And I verify for account group "$<accountGroupName>" IDEL Limit is "$<IDELLimit>"
  And I verify for account group "$<accountGroupName>" Pool Balance Type is "$<poolBalanceType>"
  And I verify for account group "$<accountGroupName>" Pool Type is "$<poolType>"
  And I verify for account group "$<accountGroupName>" Name is "$<accountGroupName>"
  And I verify for account group "$<accountGroupName>" Address is "$<address>"
  And I verify for account group "$<accountGroupName>" Description is "$<description>"
  And I verify for account group "$<accountGroupName>" Bank Legal Entity is "$<bankLegalEntity>"
  And I verify for account group "$<accountGroupName>" FX Rate Type is "$<fXRateType>"
  And I verify for account group "$<accountGroupName>" Accounts is "$<accounts>"
  And I remove accounts group filter "Name:$<accountGroupName>"


@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#verifies can not use already used account to create new fund
#Example: And I verify can not use already used account "HDFUSDAC2" to create new fund in account group
#--------------------------------------------------------------------------------------
Scenario: I verify can not use already used account "<accountIs>" to create new fund in account group
 And I open create account group form
 And I select "Fund" from "Account Group Type" in account group form
 And result is defined by javascript
 """
 (function getResult(){
   var result;var found=false;
   $('p:contains("ACCOUNTS AVAILABLE")').parent().siblings('select').find('option').each(function(){
	  if($(this).text().trim() == "$<accountIs>"){
		  result="";
      return false;
  	}else{
         result="Done";
    }
  })
   return result;
 })()
 """
 And result should be "Done"
 And I close create account group form



 @StepDef
 ###########################################################################################################
 #----------------------------------------------------------------------------------------------------------
 #Step to verify accounts can be selected 
 #Example:And I verify "AUTOACC1,AUTOACC2,AUTOACC3" accounts can be selected in account group form
 #----------------------------------------------------------------------------------------------------------
 Scenario: I verify "<accounts>" accounts can be selected in account group form
    And I open create account group form
    And I select "Fund" from "Account Group Type" in account group form
    And value is present is defined by javascript "(function() {return "$<accounts>" != "''"})();"
    And I add accounts "$<accounts>" in account group form if value is present
    And I capture the current screenshot
    And I close create account group form

 @StepDef
 ############################################################
 #-----------------------------------------------------------
 #Step to account is selected
 #Example:And I verify "ACCACCOUNT1" is selected in account group form
 #-----------------------------------------------------------
 Scenario:I verify "<selectaccount>" is selected in account group form
 And accountPresentInToList is defined by javascript
 """
 (function getResult(){
   var result="";
   $('p:contains("ACCOUNTS INCLUDED")').parent().siblings('select').find('option').each(function(){
     if(($(this).text().trim()) == "$<selectaccount>")
       result="Done";
   });
   return result;
 })()
 """
 And accountPresentInToList should be "Done"
 And accountNotPresentInFromList is defined by javascript
 """
 (function getResult(){
   var result="";
   if($('p:contains("ACCOUNTS AVAILABLE")').parent().siblings('select').find('option').get(0)==null)
     result="Done";
     $('p:contains("ACCOUNTS AVAILABLE")').parent().siblings('select').find('option').each(function(){
     if(($(this).text().trim()) != "$<selectaccount>")
       result="Done";
     else{result="";return false;}
   });
   return result;
 })()
 """
 And accountNotPresentInFromList should be "Done"

 @StepDef
 ############################################################
 #-----------------------------------------------------------
 #Step to verify account is removed
 #Example:And I verify "HDF1" is removed in account group form
 #-----------------------------------------------------------
 Scenario:I verify "<selectaccount>" is removed in account group form
   And accountPresentInFromList is defined by javascript
   """
   (function getResult(){
     var result="";
       $('p:contains("ACCOUNTS AVAILABLE")').parent().siblings('select').find('option').each(function(){
       if(($(this).text().trim()) == "$<selectaccount>")
         result="Done";
     });
     return result;
   })()
   """
   And accountPresentInFromList should be "Done"
   And accountNotPresentInToList is defined by javascript
   """
   (function getResult(){
     var result="";
     if($('p:contains("ACCOUNTS INCLUDED")').parent().siblings('select').find('option').get(0)==null)
       result="Done";
       $('p:contains("ACCOUNTS INCLUDED")').parent().siblings('select').find('option').each(function(){
       if(($(this).text().trim()) != "$<selectaccount>"){
         result="Done";
         }else{result="";return false;}
     });
     return result;
   })()
   """
   And accountNotPresentInToList should be "Done"

 @StepDef
 ###########################################################################################################
 #----------------------------------------------------------------------------------------------------------
 #Step to select accounts after applying filter in account group form
 #Example:And I select accounts "AUTOACC01,AUTOACC02,AUTOACC03" by applying "AUTO" on account filter in account group form
 #----------------------------------------------------------------------------------------------------------
 Scenario:I select accounts "<accounts>" by applying "<filteraccounts>" on account filter in account group form
 And I open create account group form
 And I select "Fund" from "Account Group Type" in account group form
 And I apply filter "$<filteraccounts>" on accounts in account group form
 And value is present is defined by javascript "(function() {return "$<accounts>" != "''"})();"
 And I add accounts "$<accounts>" in account group form if value is present
 And I capture the current screenshot


 @StepDef
 ###########################################################################################################
 #----------------------------------------------------------------------------------------------------------
 #Step to select and verify filtering in create fund form
 #Example:And I apply filter "HSSACC#$" on accounts in account group form
 #----------------------------------------------------------------------------------------------------------
 Scenario: I apply filter "<filteraccounts>" on accounts in account group form
 And accountIs is "$<filteraccounts>"
 And value is present is defined by javascript "(function() {return "$<filteraccounts>" != "''"})();"
 And I enter account filter "${filteraccount}" in account group form for each filteraccount in accountIs delimited by "," if value is present

 @StepDef
 ###########################################################################################################
 #----------------------------------------------------------------------------------------------------------
 #Step to apply account filter on account group form 
 #Example:And I enter account filter "AUTOACC1" in account group form
 #----------------------------------------------------------------------------------------------------------
 Scenario: I enter account filter "<filteraccount>" in account group form
 And I type "$<filteraccount>" in account filter fromField for accountGroupForm
 And filtered is defined by javascript
 """
 (function(){
   str="";
   $('p:contains("ACCOUNTS AVAILABLE")').parent().siblings('select').find('option').each(function()
 {
   if($(this).text().trim().indexOf("$<filteraccount>") >= 0)
       str="done";
   else{str="";return false;}
 });
 return str;
 })()
 """
 Then filtered should be "done"
 And I capture the current screenshot



 @StepDef
 ###########################################################################################################
 #----------------------------------------------------------------------------------------------------------
 #Step to remove filter in create fund form
 #Example:And I remove account filter in account group form
 #----------------------------------------------------------------------------------------------------------
 Scenario: I remove account filter in account group form
   And I clear account filter fromField for accountGroupForm
   And I capture the current screenshot
   ##WA##
   And removeAccountFilterFromField can be located by javascript "$('div:contains("ACCOUNTS AVAILABLE") > div.stl-multi-select-search-wrapper i.fa-times')"
   And I click removeAccountFilterFromField
   And options present is defined by javascript
   """
   (function(){
   str="";
   if($('p:contains("ACCOUNTS AVAILABLE")').parent().siblings('select').find('option').get(0)!=null)
       str="done";
   return str;
   })()
   """
   Then options present should be "done"
   And I capture the current screenshot


 @StepDef
 #######################################################################################
 #--------------------------------------------------------------------------------------
 #verifies can select all accounts and remove all accounts for fund in account group form
 #Example: And I verify select all and remove all accounts in account group form
 #--------------------------------------------------------------------------------------
 Scenario: I verify select all and remove all accounts in account group form
  And I click addAll button
  And no options in from is defined by javascript
  """
  (function(){
  str="";
  if($('p:contains("ACCOUNTS AVAILABLE")').parent().siblings('select').find('option').get(0)==null)
  		str="done";
  return str;
  })()
  """
  Then no options in from should be "done"
  And I capture the current screenshot
  And I click removeAll button
  And no options in to is defined by javascript
  """
  (function(){
  str="";
  if($('p:contains("ACCOUNTS INCLUDED")').parent().siblings('select').find('option').get(0)==null)
  		str="done";
  return str;
  })()
  """
  Then no options in to should be "done"
  And I capture the current screenshot

@StepDef
@DataTable(header="top")
#######################################################################################
#----------------------------------------------------------------------------------------
#Step to add new strategy on account group dashboard
#Example:And I add new strategy
#|StrategyName|ExecutionDays|ActionName|ActionType|ExecutionWindow|Suggestions                                         |
#|MYSTRAT     |3            |MYACT     |Sweep     | 1 Day         | Primary Currency:USD;AED Primary Account:FNDAEDP1  |
#----------------------------------------------------------------------------------------
Scenario: I add new strategy
  And I add new strategy as "${data[StrategyName]}" having "${data[ExecutionDays]}" execution days with "${data[ActionName]}" of type "${data[ActionType]}" having execution window "${data[ExecutionWindow]}" and suggestion of "${data[Suggestions]}" for each data record

@StepDef
#######################################################################################
#----------------------------------------------------------------------------------------
#Step to add new strategy on account group dashboard
#Example:And I add new strategy as "MYSTRAT" having "3" execution days with "MYACT" of type "Sweep" having "3" execution window and suggestion of Primary Currency with value "HDF"
#----------------------------------------------------------------------------------------
Scenario: I add new strategy as "<strategyName>" having "<executionDays>" execution days with "<actionName>" of type "<actionType>" having execution window "<executionWindow>" and suggestion of "<suggestions>"
    And I scroll to the top of strategiesHeader
    And strategyAbsent is defined by javascript
    """
    (function(){
    	var result=true;
    	var actionNameTextNode=document.evaluate("//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = \"$<strategyName>\"]]", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
    	if(actionNameTextNode!=null && actionNameTextNode.textContent=="$<strategyName>")
    		result=false;
    	return result;
    })()
    """
    And I add new strategy of name "$<strategyName>" having "$<executionDays>" execution days if strategyAbsent
    And actionPresent is defined by javascript "(function(){return ("$<actionName>" != "''") })()"
    And I add action "$<actionName>" of type "$<actionType>" having execution window "$<executionWindow>" for "$<strategyName>" strategy if actionPresent
    And suggestionPresent is defined by javascript "(function(){return ("$<suggestions>" != "''") })()"
    And suggestionsAre is "$<suggestions>"
    And I show "$<actionName>" action menu options for "$<strategyName>" strategy if suggestionPresent
    And I edit suggest structure with "${suggestThis}" for "$<strategyName>" strategy with "$<actionName>" action for each suggestThis in suggestionsAre delimited by ";" if suggestionPresent
    And I click on create suggestion for "$<actionName>" action of "$<strategyName>" strategy if suggestionPresent
    And I save and confirm account group
    

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to rename and add details to strategy
#Example: And I add new strategy of name "MYSTRAT" having "3" execution days
#--------------------------------------------------------------------------------------
Scenario:I add new strategy of name "<strategyName>" having "<executionDays>" execution days
    And I scroll to the bottom of strategiesHeader
    And I click addStrategyButton
    And I rename strategy "STRATEGY NAME" to name "$<strategyName>"
    And executionDaysPresent is defined by javascript "(function(){return ("$<executionDays>" != "''") })()"
    And I change Execution Days for "$<strategyName>" strategy to "$<executionDays>" if executionDaysPresent


@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to rename strategy
#Example: And I rename strategy "STRATEGY NAME" to name "MYSTRAT"
#--------------------------------------------------------------------------------------
Scenario:I rename strategy "<strategyOldName>" to name "<strategyName>"
  And I show "$<strategyOldName>" strategy menu options
  And defaultNameForStrategy can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyOldName>"]]"
  And I scroll to the bottom of defaultNameForStrategy
  And I click defaultNameForStrategy
  And nameField can be located by xpath "//stl-strategy-form/stl-expansion-panel//stl-action-name//input"
  And textPresent is defined by javascript
  """
  (function(){
    var result=false;
    var strategyNameTextNode=document.evaluate("//stl-strategy-form/stl-expansion-panel//stl-action-name//input", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
    if(strategyNameTextNode.value!="")
      result=true;
    console.log("Value Present: "+result);
    return result;
  })()
  """
  And I send "BACK_SPACE" to nameField while textPresent using 10 millisecond delay and 2 minute timeout
  And value is present is defined by javascript "(function() {return "$<strategyName>" != "''"})()"
  And I type "$<strategyName>" in nameField if value is present
  And I send "ENTER" to nameField


@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to change property of strategy
#Example: And I change Execution Days for "MYSTRAT" strategy to "3 days"
#--------------------------------------------------------------------------------------
Scenario:I change <property> for "<strategyName>" strategy to "<value>"
  And I show "$<strategyName>" strategy menu options
  And value is present is defined by javascript "(function() {return "$<value>" != "''"})()"
  And propertyDropdown can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-form-field//label[text()[normalize-space() = "$<property>"]]/ancestor::stl-form-field//select"
  And I select "$<value>" in propertyDropdown  if value is present

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to rename and add action to strategy
#Example: And I add action "MYACT" of type "Sweep" having execution window "3 Days" for "MYSTRAT" strategy
#--------------------------------------------------------------------------------------
Scenario:I add action "<actionName>" of type "<actionType>" having execution window "<executionWindow>" for "<strategyName>" strategy
  And I click on add action for "$<strategyName>" strategy
  And I rename action "ACTION X: ACTION NAME" to name "$<actionName>" for "$<strategyName>" strategy
  And I change Type to "$<actionType>" for "$<actionName>" action of "$<strategyName>" strategy
  And I change Execution Window to "$<executionWindow>" for "$<actionName>" action of "$<strategyName>" strategy

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to click on add action for particular strategy
#Example: And I click on add action for "MYSTRAT" strategy
#--------------------------------------------------------------------------------------
Scenario:I click on add action for "<strategyName>" strategy
  And I show "$<strategyName>" strategy menu options
  And addActionOnStrategyButton can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]//ancestor::div[contains(@class,'stl-expansion-panel-header')]//stl-icon/i[contains(@class,'fa-plus')]"
  And I click addActionOnStrategyButton

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to click on save strategy for particular strategy
#Example: And I click on save strategy for "MYSTRAT" strategy
#--------------------------------------------------------------------------------------
Scenario:I click on save strategy for "<strategyName>" strategy
  And I show "$<strategyName>" strategy menu options
  And saveStrategyButton can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//button//span[text()[normalize-space() = 'Save Strategy']]"
  And I scroll to the bottom of saveStrategyButton
  And I click saveStrategyButton

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to click on create suggestion
#Example: And I click on create suggestion for "MYACT" action of "MYSTRAT" strategy
#--------------------------------------------------------------------------------------
Scenario:I click on create suggestion for "<actionName>" action of "<strategyName>" strategy
  And I show "$<strategyName>" strategy menu options
  And createSuggestionButton can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-expansion-panel[1]//div[text()[normalize-space() = 'Suggest New Structure']]/ancestor::stl-sweep-action-form//button//span[text()[normalize-space() = 'Create Suggestion']]"
  And I click createSuggestionButton

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to rename strategy
#Example: And I rename action "MYACT" to name "MyNewAct" for "STRATEGY NAME" strategy
#--------------------------------------------------------------------------------------
Scenario:I rename action "<actionOldName>" to name "<actionName>" for "<strategyName>" strategy
  And I show "$<actionOldName>" action menu options for "$<strategyName>" strategy
  And defaultNameForAction can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionOldName>"]]"
  And I scroll to the bottom of defaultNameForAction
  And I click defaultNameForAction
  And actionNameField can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//stl-action-name//input"
  And textPresent is defined by javascript
  """
  (function(){
  	var result=false;
  	var actionNameTextNode=document.evaluate("//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = \"$<strategyName>\"]]/ancestor::stl-expansion-panel//stl-action-form//stl-action-name//input", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
  	if(actionNameTextNode.value!="")
  		result=true;
    console.log("Value Present: "+result);
  	return result;
  })()
  """
  And I send "BACK_SPACE" to actionNameField while textPresent using 10 millisecond delay and 2 minute timeout
  And value is present is defined by javascript "(function() {return "$<actionName>" != "''"})()"
  And I type "$<actionName>" in actionNameField if value is present
  And I send "ENTER" to actionNameField

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to change property of action for specific strategy
#Example: And I change Type to "Sweep" for "MYACT" action of "MYSTRAT" strategy
#Example: And I change Execution Window to "3 Days" for "MYACT" action of "MYSTRAT" strategy
#--------------------------------------------------------------------------------------
Scenario:I change <property> to "<value>" for "<actionName>" action of "<strategyName>" strategy
  And value is present is defined by javascript "(function() {return "$<value>" != "''"})()"
  And I show "$<actionName>" action menu options for "$<strategyName>" strategy if value is present
  And actionPropertyDropdown can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-action-form//label[text()[normalize-space() = "$<property>"]]/ancestor::stl-form-field//select"
  And I select "$<value>" in actionPropertyDropdown if value is present

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to edit suggestion in specific action of particular strategy
#Example:And I edit suggest structure with "Primary Currency:USD" for "MYSTRAT" strategy with "MYACT" action
#--------------------------------------------------------------------------------------
Scenario:I edit suggest structure with "<suggestion>" for "<strategyName>" strategy with "<actionName>" action
  And selectionIs is "$<suggestion>"
  And selectionTypeIs is defined by javascript
  """
  (function() {
    var valIs = "${selectionIs}".split(':');
    return valIs[0];
  })()
  """
  And selectionType is "${selectionTypeIs}"
  And selectionValueIs is defined by javascript
  """
  (function() {
    var valIs = "${selectionIs}".split(':');
    return valIs[1];
  })()
  """
  And selectionValue is "${selectionValueIs}"
  And I add in suggest structure "${selectionType}" with value "${selectionValue}" for "$<strategyName>" strategy with "$<actionName>" action


@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to add suggestion in specific action of particular strategy
#Example:And I add in suggest structure "Primary Currency" with value "HDF" for "MYSTRAT" strategy with "MYACT" action
#--------------------------------------------------------------------------------------
Scenario:I add in suggest structure "<suggestion>" with value "<value>" for "<strategyName>" strategy with "<actionName>" action
  And value is present is defined by javascript "(function() {return "$<value>" != "''"})()"
  And suggestionDropdown can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-expansion-panel[1]//div[text()[normalize-space() = 'Suggest New Structure']]/ancestor::stl-sweep-action-form//label[text()[normalize-space() = '$<suggestion>']]/ancestor::stl-form-field//select"
  And I select "$<value>" in suggestionDropdown if value is present


@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to remove action to strategy
#Example: And I remove action "MYACT" for "MYSTRAT" strategy
#--------------------------------------------------------------------------------------
Scenario:I remove action "<actionName>" for "<strategyName>" strategy
  And I scroll to the top of strategiesHeader
  And I show "$<strategyName>" strategy menu options
  And I show "$<actionName>" action menu options for "$<strategyName>" strategy
  And removeActionButton can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]//ancestor::div[contains(@class,'stl-expansion-panel-header')]//stl-icon/i[contains(@class,'fa-trash')]"
  And I click removeActionButton

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to check and show or hide strategy menu options
#Example: And I show "MYSTRAT" strategy menu options
#Example: And I hide "MYSTRAT" strategy menu options
#--------------------------------------------------------------------------------------
Scenario:I <type> "<strategyName>" strategy menu options
  And I scroll to the top of strategiesHeader
  And showHideStrategyMenuButton can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]//ancestor::div[contains(@class,'stl-expansion-panel-header')]//stl-icon/i[contains(@class,'fa-angle')]"
  And I scroll to the bottom of showHideStrategyMenuButton
  And actionToPerform is defined by javascript
  """
  (function(){
    var result=false;
    var strategyShowHideButton=document.evaluate("//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = \"$<strategyName>\"]]//ancestor::div[contains(@class,'stl-expansion-panel-header')]//stl-icon/i[contains(@class,'fa-angle')]", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
    if((strategyShowHideButton.className.indexOf("fa-angle-down")>=0 && "$<type>"=="show")||(strategyShowHideButton.className.indexOf("fa-angle-up")>=0 && "$<type>"=="hide"))
      result=true;
    return result;
  })()
  """
  And I click showHideStrategyMenuButton if actionToPerform

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to check and show or hide strategy menu options
#Example: And I show "MYACT" action menu options for "MYSTRAT" strategy
#Example: And I hide "MYACT" action menu options for "MYSTRAT" strategy
#--------------------------------------------------------------------------------------
Scenario:I <type> "<actionName>" action menu options for "<strategyName>" strategy
  And I scroll to the top of strategiesHeader
  And I show "$<strategyName>" strategy menu options
  And I scroll to the top of strategiesHeader
  And showHideActionMenuButton can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]//ancestor::div[contains(@class,'stl-expansion-panel-header')]//stl-icon/i[contains(@class,'fa-angle')]"
  And I scroll to the bottom of showHideActionMenuButton
  And actionToPerform is defined by javascript
  """
  (function(){
    var result=false;
    var strategyActionShowHideButton=document.evaluate("//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = \"$<strategyName>\"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = \"$<actionName>\"]]//ancestor::div[contains(@class,'stl-expansion-panel-header')]//stl-icon/i[contains(@class,'fa-angle')]", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
    if((strategyActionShowHideButton.className.indexOf("fa-angle-down")>=0 && "$<type>"=="show")||(strategyActionShowHideButton.className.indexOf("fa-angle-up")>=0 && "$<type>"=="hide"))
      result=true;
    return result;
  })()
  """
  And I click showHideActionMenuButton if actionToPerform

@StepDef
@DataTable(header="top")
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to create suggestion in specific action of particular strategy
#Example:And I create "MYACT" action of type "Sweep" having execution window "3 Days" for "Default strategy for 'FND32'" strategy
#|Suggestion|SuggestionValue|
#|Primary Currency|USD|
#|AED Primary Account|HDFAEDAC1|
#--------------------------------------------------------------------------------------
Scenario:I create "<actionName>" action of type "<actionType>" having execution window "<executionWindow>" for "<strategyName>" strategy
    And I only click edit account group
    And I add action "$<actionName>" of type "$<actionType>" having execution window "$<executionWindow>" for "$<strategyName>" strategy
    And I show "$<actionName>" action menu options for "$<strategyName>" strategy if value is present
    And I add in suggest structure "${data[Suggestion]}" with value "${data[SuggestionValue]}" for "$<strategyName>" strategy with "$<actionName>" action for each data record
    And I click on create suggestion for "$<actionName>" action of "$<strategyName>" strategy if value is present
    And I save and confirm account group


@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to verify property of action for specific strategy
#Example: And I verify Type is having value "Sweep" for "MYACT" action of "MYSTRAT" strategy
#Example: And I verify Execution Window is having value "3 Days" for "MYACT" action of "MYSTRAT" strategy
#--------------------------------------------------------------------------------------
Scenario:I verify <property> is having value "<value>" for "<actionName>" action of "<strategyName>" strategy
  And value is present is defined by javascript "(function() {return "$<value>" != "''"})()"
  And I show "$<actionName>" action menu options for "$<strategyName>" strategy if value is present
  And actionPropertyDropdown can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-action-form//label[text()[normalize-space() = "$<property>"]]/ancestor::stl-form-field//select"
  And actionPropertyDropdown text should be "$<value>" if value is present


@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to verify property of strategy
#Example: And I verify Execution Days for "MYSTRAT" strategy is "3 Days"
#--------------------------------------------------------------------------------------
Scenario:I verify <property> for "<strategyName>" strategy is "<value>"
  And I show "$<strategyName>" strategy menu options
  And value is present is defined by javascript "(function() {return "$<value>" != "''"})()"
  And propertyDropdown can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-form-field//label[text()[normalize-space() = "$<property>"]]/ancestor::stl-form-field//select"
  And propertyDropdown text should be "$<value>" if value is present

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to verify suggestion in specific action of particular strategy
#Example:And I verify in suggest structure "Primary Currency" has value "HDF" for "MYSTRAT" strategy with "MYACT" action
#--------------------------------------------------------------------------------------
Scenario:I verify in suggest structure "<suggestion>" has value "<value>" for "<strategyName>" strategy with "<actionName>" action
  And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
  And suggestionDropdown can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-expansion-panel[1]//div[text()[normalize-space() = 'Suggest New Structure']]/ancestor::stl-sweep-action-form//label[text()[normalize-space() = '$<suggestion>']]/ancestor::stl-form-field//select"
  And suggestionDropdown text should be "$<value>"

@StepDef
#-----------------------------------------------------------------
#Step to scroll to sweep suggestions grid column
#Example: And I scroll to sweep suggestions grid column "Amount"
#-----------------------------------------------------------------
Scenario: I scroll to sweep suggestions grid column "<columnName>"
  And I execute javascript "count=1;"
  And scrolling is defined by javascript
  """
  (function(){
  var result=""; var scrollDone="";var colId="";
  function scrollSearch(){
    scrollPos=$('ag-grid-angular .ag-body-viewport').scrollLeft();
    $('ag-grid-angular .ag-body-viewport').scrollLeft(200*(count++));
    console.log(scrollPos+"  "+count);
  }
  $('.ag-header-container .ag-header-cell span.ag-header-cell-text').filter(function()
  {
   if($(this).text().trim()=="$<columnName>")
   {
   $(this).parents().filter(function()
     {
     if($(this).attr('col-id')!=null)
       {
         colId=$(this).attr('col-id')
       }
     }
   )}
 })
  if($('ag-grid-angular [col-id*="'+colId+'"] span:contains("$<columnName>")').parent().siblings().get(0)==null){
    console.log("in if");
    scrollSearch();
  }else{
    console.log("in else");
    result="Done";
  }
  return result;

  })()
  """
  And scrolling should be "Done"


@StepDef
@DataTable(header="top")
#----------------------------------------------------------------------------------------
#Step to exclude sweep pair with datatable
#Example:And I exclude sweep pair for "MYACT" action of "Default strategy for 'FND32'" strategy
#----------------------------------------------------------------------------------------
Scenario: I exclude sweep pair for "<actionName>" action of "<strategyName>" strategy
    And I only click edit account group 
    And I show "$<actionName>" action menu options for "$<strategyName>" strategy
    And I exclude sweep pair having parent account "${data[parentAccount]}" and child account "${data[childAccount]}" for "$<actionName>" action of "$<strategyName>" strategy for each data record
    And I save and confirm account group
    And I only click edit account group 
    And I verify sweep pair having parent account "${data[parentAccount]}" and child account "${data[childAccount]}" for "$<actionName>" action of "$<strategyName>" strategy is having status "EXCLUDED" for each data record
    

@StepDef
@DataTable(header="top")
#----------------------------------------------------------------------------------------
#Step to include sweep pair with datatable
#Example:And I include sweep pair for "MYACT" action of "Default strategy for 'FND32'" strategy
##| parentAccount | childAccount |
##| FND32USDM     | FND32GBPP1   |
#----------------------------------------------------------------------------------------
Scenario: I include sweep pair for "<actionName>" action of "<strategyName>" strategy
    And I only click edit account group 
    And I show "$<actionName>" action menu options for "$<strategyName>" strategy
    And I include sweep pair having parent account "${data[parentAccount]}" and child account "${data[childAccount]}" for "$<actionName>" action of "$<strategyName>" strategy for each data record
    And I save and confirm account group
    And I only click edit account group  
    And I verify sweep pair having parent account "${data[parentAccount]}" and child account "${data[childAccount]}" for "$<actionName>" action of "$<strategyName>" strategy is having status "INCLUDED" for each data record
   

@StepDef
#-------------------------------------------------------------
#Step to include/exclude sweep pair without datatable
#Example:And I include sweep pair having parent account "FND32USDM" and child account "FND32GBPP1" for "MYACT" action of "Default strategy for 'FND32'" strategy
#-------------------------------------------------------------
Scenario: I <actionToPerform> sweep pair having parent account "<parentAccount>" and child account "<childAccount>" for "<actionName>" action of "<strategyName>" strategy
    And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
    And filterIs is "Account Code:$<childAccount>"
    And I enter filter on sweep suggestions "${selectFilter}" for each selectFilter in filterIs delimited by ";"
    And parentAccount is present is defined by javascript "(function() {return "$<parentAccount>" != "''" && "$<parentAccount>" != "" })()"
    And noParentAccount is present is defined by javascript "(function() {return "$<parentAccount>" == "''" || "$<parentAccount>" == "" })()"
    And rowToBeSelected can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'parentAccount')][text()[normalize-space() = '$<parentAccount>']]" if parentAccount is present
    And rowToBeSelected can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]" if noParentAccount is present
    And isInclude is defined by javascript "(function() {return "$<actionToPerform>" == "include"})();"
    And isExcluded is defined by javascript "(function() {return "$<actionToPerform>" == "exclude"})();"
    And I click rowToBeSelected
    And I right click rowToBeSelected
    And I click excludeSweepButton if isExcluded
    And I click includeSweepButton if isInclude
    And statusColumn can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'parentAccount')][text()[normalize-space() = '$<parentAccount>']]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'status')]" if parentAccount is present
    And statusColumn can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'status')]" if noParentAccount is present
    And statusColumn should be "EXCLUDED" if isExcluded
    And statusColumn should be "INCLUDED" if isInclude

@StepDef
#-------------------------------------------------------------
#Step to verify status of sweep pair
#Example:And I verify sweep pair having parent account "parentAccount" and child account "childAccount" for "<actionName>" action of "<strategyName>" strategy is having status "EXCLUDED"
#-------------------------------------------------------------
Scenario: I verify sweep pair having parent account "<parentAccount>" and child account "<childAccount>" for "<actionName>" action of "<strategyName>" strategy is having status "<status>"
    And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
    And filterIs is "Account Code:$<childAccount>"
    And I enter filter on sweep suggestions "${selectFilter}" for each selectFilter in filterIs delimited by ";"
    And parentAccount is present is defined by javascript "(function() {return "$<parentAccount>" != "''" && "$<parentAccount>" != "" })()"
    And noParentAccount is present is defined by javascript "(function() {return "$<parentAccount>" == "''" || "$<parentAccount>" == "" })()"
    And statusColumn can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'status')]" if noParentAccount is present
    And statusColumn can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'parentAccount')][text()[normalize-space() = '$<parentAccount>']]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'status')]" if parentAccount is present
    And statusColumn should be "$<status>"
    And rowToBeSelected can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]" if noParentAccount is present
    And rowToBeSelected can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'parentAccount')][text()[normalize-space() = '$<parentAccount>']]" if parentAccount is present
    And I click rowToBeSelected
    And I right click rowToBeSelected
    And buttonNotPresent is defined by javascript
    """
      (function(){
          var buttonPresent;var result="false";var buttonAbsent;
          if("$<status>" == "EXCLUDED"){
            buttonPresent="Include";
            buttonAbsent="Exclude";
          }
           if("$<status>" == "INCLUDED"){
             buttonPresent="Exclude";
             buttonAbsent="Include";
           }
          var buttonNodePresent=document.evaluate("//div[@class='ag-menu']//span[text()[normalize-space() = '"+buttonPresent+"']]", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
          var buttonNodeAbesent=document.evaluate("//div[@class='ag-menu']//span[text()[normalize-space() = '"+buttonAbsent+"']]", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
          if(buttonNodePresent!=null && buttonNodeAbesent==null)
            result="true";
          return result;
      })()
    """
    And buttonNotPresent should be "true"

@StepDef
#-------------------------------------------------------------
#Step to enter filter on sweep pair grid
#Example:And I apply sweep suggestions filter "Account:HDFAUDAC1" on account group dashboard
#-------------------------------------------------------------
Scenario: I apply sweep suggestions filter "<filter>" on account group dashboard
    And filterIs is "$<filter>"
    And I enter filter on sweep suggestions "${selectFilter}" for each selectFilter in filterIs delimited by ";"

@StepDef
#-----------------------------------------------------------------
#Step to enter filter on sweep pair grid
#Example:And I enter filter on sweep suggestions "Amount:90989.898"
#-----------------------------------------------------------------
Scenario: I enter filter on sweep suggestions "<filter>"
    And I get filter details for "$<filter>"
    And I scroll to sweep suggestions grid column "${filterNameIs}"
    And more option menu can be located by xpath "//stl-sweep-action-form//ag-grid-angular//span[text()[normalize-space() = "${filterNameIs}"]]/../../span"
    And I wait for more option menu
    And I click more option menu
    ##WA##And open more option menu is defined by javascript
    ##"""
    ## (function(){
    ##   var result="";
    ##    var moreOptionMenu=$('stl-structure-grid span').filter(function() {
    ##        return $(this).text() === "${filterNameIs}";
    ##    }).parent().siblings().get(0);
    ##    if(moreOptionMenu!=null){
    ##     moreOptionMenu.click();
    ##     result="Done";
    ##    }
    ##    return result;
    ##  })()
    ##  """
    ##WA##And open more option menu should be "Done"
    And I wait for filter menu
    And notOnFilterTab is defined by javascript "!$('[class="ag-icon ag-icon-filter"]').parent().hasClass("ag-tab-selected")"
    ##WA##And I click filter menu if notOnFilterTab
    And get on filter menu is defined by javascript
    """
    (function(){
      var result="";
      var filterOptionMenu=$('[ref="tabHeader"] [class="ag-icon ag-icon-filter"]').get(0);
      if(filterOptionMenu!=null){
        filterOptionMenu.click();
        result="Done";
      }
      return result;
    })()
    """
    And get on filter menu should be "Done" if notOnFilterTab
    And setPerspectiveFilterInputField can be located by javascript "$('input[class="ag-filter-filter"]').get(0)"
    And setPerspectiveFilterToInputField can be located by javascript "$('input[class="ag-filter-filter"]').get(1)"
    And cbFilters is present is defined by javascript "(function() {return "${filterNameIs}" != "''" && "${filterNameIs}" != "IDEL Pool Limit"})();"
    And Amount filter is present is defined by javascript "(function() {return "${filterNameIs}" != "''" && "${filterNameIs}" == "IDEL Pool Limit"})();"
    And I set account group filter for cbfilter if cbFilters is present
    And I set account group filter for Amount if Amount filter is present
    And filterTabVisible is defined by javascript "$('[class="ag-icon ag-icon-filter"]').parent().hasClass("ag-tab-selected")"
    And I click filter menu if filterTabVisible
    And I scroll to the top of strategiesHeader

@StepDef
#-------------------------------------------------------------
#Step to remove sweep suggestions account group filter
#Example:And I remove sweep suggestions filter "Account:HDFAUDAC1" on account group dashboard
#-------------------------------------------------------------
Scenario: I remove sweep suggestions filter "<filter>" on account group dashboard
    And filterIs is "$<filter>"
    And I remove filter on sweep suggestions "${selectFilter}" for each selectFilter in filterIs delimited by ";"

@StepDef
#-----------------------------------------------------------------
#Step to remove filter name in sweep suggestions account group
#Example:And I remove filter on sweep suggestions "Amount:90989.898"
#-----------------------------------------------------------------
Scenario: I remove filter on sweep suggestions "<filter>"
    And I get filter details for "$<filter>"
    And I scroll to sweep suggestions grid column "${filterNameIs}"
    And more option menu2 can be located by xpath "//stl-sweep-action-form//ag-grid-angular//span[text()[normalize-space() = "${filterNameIs}"]]/../../span"
    And I wait for more option menu2
    And I click more option menu2
    ##WA##And open more option menu is defined by javascript
    ##"""
    ## (function(){
    ##   var result="";
    ##    var moreOptionMenu=$('stl-structure-grid span').filter(function() {
    ##        return $(this).text() === "${filterNameIs}";
    ##    }).parent().siblings().get(0);
    ##    if(moreOptionMenu!=null){
    ##     moreOptionMenu.click();
    ##     result="Done";
    ##    }
    ##    return result;
    ##  })()
    ##  """
    ##WA##And open more option menu should be "Done"
    And I wait for filter menu
    And notOnFilterTab is defined by javascript "!$('[class="ag-icon ag-icon-filter"]').parent().hasClass("ag-tab-selected")"
    ##WA##And I click filter menu if notOnFilterTab
    And get on filter menu is defined by javascript
    """
    (function(){
      var result="";
      var filterOptionMenu=$('[ref="tabHeader"] [class="ag-icon ag-icon-filter"]').get(0);
      if(filterOptionMenu!=null){
        filterOptionMenu.click();
        result="Done";
      }
      return result;
    })()
    """
    And get on filter menu should be "Done" if notOnFilterTab
    And setPerspectiveFilterInputField can be located by javascript "$('input[class="ag-filter-filter"]').get(0)"
    And setPerspectiveFilterToInputField can be located by javascript "$('input[class="ag-filter-filter"]').get(1)"
    And cbFilters is present is defined by javascript "(function() {return "${filterNameIs}" != "''" && "${filterNameIs}" != "IDEL Pool Limit"})();"
    And Amount filter is present is defined by javascript "(function() {return "${filterNameIs}" != "''" && "${filterNameIs}" == "IDEL Pool Limit"})();"
    And I unset account group filter for cbfilter if cbFilters is present
    And I unset account group filter for Amount if Amount filter is present
    And filterTabVisible is defined by javascript "$('[class="ag-icon ag-icon-filter"]').parent().hasClass("ag-tab-selected")"
    And I click filter menu if filterTabVisible
    And I scroll to the top of strategiesHeader

@StepDef
@DataTable(header="top")
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to verify mandatory fields specific action of particular strategy
#Example:And I verify fields for "''" action of Type "Sweep" for "Default strategy for 'FND32'" strategy of "FUND32" account group
#Example:And I verify fields for "ACTION X: ACTION NAME" action of Type "Sweep" for "Default strategy for 'FND32'" strategy of "FUND32" account group
#|MandatoryFieldName|
#|Primary Currency|
#|AED Primary Account|
#--------------------------------------------------------------------------------------
Scenario:I verify fields for "<actionName>" action of <property> "<actionType>" for "<strategyName>" strategy of "<accountGroupName>" account group
  And actionIsAbsent is defined by javascript "(function() {return "$<actionName>" == "''"})()"
  And actionIsPresent is defined by javascript "(function() {return "$<actionName>" != "''"})()"
  And actionTypeIsSweep is defined by javascript "(function() {return "$<actionType>" == "Sweep" && "$<actionType>"!="''"})()"
  And newActionName is "ACTION X: ACTION NAME" if actionIsAbsent
  And newActionName is "$<actionName>" if actionIsPresent
  And I click on add action for "$<strategyName>" strategy if actionIsAbsent
  And I show "${newActionName}" action menu options for "$<strategyName>" strategy
  And I save and cancel account group
  And I verify "${data[MandatoryFieldName]}" action type field is mandatory field for "${newActionName}" action of "$<strategyName>" strategy for each data record
  And I change $<property> to "$<actionType>" for "${newActionName}" action of "$<strategyName>" strategy
  And I get currencies in currencyList for account group "$<accountGroupName>"
  And I check order in suggest structure of "Primary Currency" is "Ascending" for "$<strategyName>" strategy with "${newActionName}" action if actionTypeIsSweep
  And I save and cancel account group if actionTypeIsSweep
  ##Not getting displayed on UI only in popup
  ##NA##And I verify error message where suggestion structure not created on "${newActionName}" action of "$<strategyName>" strategy if actionTypeIsSweep
  And I verify "Primary Currency" suggest structure field warning "${primaryCurrencyWarning}" for "${newActionName}" action of "$<strategyName>" strategy if actionTypeIsSweep
  And I verify "${currency} Primary Account" suggest structure field warning "${primaryAccountWarning}" for "${newActionName}" action of "$<strategyName>" strategy for each currency in currencyList delimited by "," if actionTypeIsSweep
  And I verify for currency "${currency}" suggest structure field error message "${primaryAccountErrorMsg}" for "${newActionName}" action of "$<strategyName>" strategy for each currency in currencyList delimited by "," if actionTypeIsSweep
  And I verify sweep suggestion fields for "${currency}" currency on "${newActionName}" action of "$<strategyName>" strategy of "$<accountGroupName>" account group for each currency in currencyList delimited by "," if actionTypeIsSweep
  And I remove action "${newActionName}" for "$<strategyName>" strategy if actionIsAbsent

@StepDef
#-------------------------------------------------------------
#Step to verify field is mandatory specific action of particular strategy
#Example:And I verify sweep suggestion fields for "GBP" currency on "MYACT" action of "MYSTRAT" strategy of "FND32" account group
#-------------------------------------------------------------
Scenario:I verify sweep suggestion fields for "<currency>" currency on "<actionName>" action of "<strategyName>" strategy of "<accountGroupName>" account group
  And I check order in suggest structure of "$<currency> Primary Account" is "Ascending" for "$<strategyName>" strategy with "$<actionName>" action
  And I add in suggest structure "Primary Currency" with value "$<currency>" for "$<strategyName>" strategy with "$<actionName>" action
  And I get accounts associated with "$<currency>" currency in accountsList for account group "$<accountGroupName>"
  And I add in suggest structure "$<currency> Primary Account" with value "${accountName}" for "$<strategyName>" strategy with "$<actionName>" action for each accountName in accountsList delimited by ","

@StepDef
#-------------------------------------------------------------
#Step to verify field is mandatory specific action of particular strategy
#Example:And I verify "Execution Window" action type field is mandatory field for "MYACT" action of "MYSTRAT" strategy
#-------------------------------------------------------------
Scenario:I verify "<actionType>" action type field is mandatory field for "<actionName>" action of "<strategyName>" strategy
  And value is present is defined by javascript "(function() {return "$<actionType>" != "''"})()"
  And actualErrorMessageText is defined by javascript "(function(){return "$<actionType>".charAt(0).toUpperCase()+"$<actionType>".toLowerCase().slice(1)+" is required." })()"
  And errorMessageText can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-action-form//label[text()[normalize-space() = "$<actionType>"]]/ancestor::stl-form-field//stl-form-error[contains(@class,"error")]//stl-form-error-message"
  And errorMessageText should be "${actualErrorMessageText}" if value is present
  And I capture the current screenshot if value is present

@StepDef
#-------------------------------------------------------------
#Step to verify suggest structure field warnings specific action of particular strategy
#Example:And I verify "AED Primary Account" suggest structure field warning "Primary account is not set for this currency." for "MYACT" action of "MYSTRAT" strategy
#-------------------------------------------------------------
Scenario:I verify "<suggestion>" suggest structure field warning "<warning>" for "<actionName>" action of "<strategyName>" strategy
  And value is present is defined by javascript "(function() {return "$<suggestion>" != "''"})()"
  And I only click save account group
  And primaryAccountWarningCheck is defined by javascript ""$<suggestion>".indexOf("Primary Account") >= 0"
  And notPrimaryAccountWarningCheck is defined by javascript ""$<suggestion>".indexOf("Primary Account") < 0"
  And currencyIs is defined by javascript ""$<suggestion>".replace("Primary Account","").trim()"
  And primaryAccountWarningMessage is defined by javascript "(function(){return "No FX/Sweep will be performed for ${currencyIs}. A Primary Account has not been set for this currency: ${currencyIs}."})()" if primaryAccountWarningCheck
  And I verify "warning" message "$<warning>" in popup after save account group for "$<actionName>" action of "$<strategyName>" strategy if notPrimaryAccountWarningCheck
  And I verify "warning" message "${primaryAccountWarningMessage}" in popup after save account group for "$<actionName>" action of "$<strategyName>" strategy if primaryAccountWarningCheck
  And I only click cancel save account group 
  And errorMessageText can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-expansion-panel[1]//div[text()[normalize-space() = 'Suggest New Structure']]/ancestor::stl-sweep-action-form//label[text()[normalize-space() = "$<suggestion>"]]/ancestor::stl-form-field//stl-form-error[contains(@type,"warning")]//stl-form-error-message"
  And errorMessageText should be "$<warning>" if value is present
  And I capture the current screenshot if value is present

@StepDef
#-------------------------------------------------------------
#Step to verify suggest structure field errors specific action of particular strategy
#Example:And I verify for currency "AED" suggest structure field error message "Primary account is not set for this currency." for "MYACT" action of "MYSTRAT" strategy
#-------------------------------------------------------------
Scenario:I verify for currency "<currency>" suggest structure field error message "<errorMessage>" for "<actionName>" action of "<strategyName>" strategy
  And value is present is defined by javascript "(function() {return "$<currency>" != "''"})()"
  And I add in suggest structure "Primary Currency" with value "$<currency>" for "$<strategyName>" strategy with "$<actionName>" action if value is present
  And I only click save account group
  And I verify "error" message "Please select a primary account for the selected primary currency $<currency> or deselect primary currency." in popup after save account group for "$<actionName>" action of "$<strategyName>" strategy
  And I only click cancel save account group 
  And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
  And errorMessageText can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-expansion-panel[1]//div[text()[normalize-space() = 'Suggest New Structure']]/ancestor::stl-sweep-action-form//label[text()[normalize-space() = "$<currency> Primary Account"]]/ancestor::stl-form-field//stl-form-error[contains(@type,"error")]//stl-form-error-message"
  And errorMessageText should be "$<errorMessage>" if value is present
  And I capture the current screenshot if value is present

@StepDef
#-------------------------------------------------------------
#Step to verify error message for suggestion structure
#Example:And I verify error message where suggestion structure not created on "MYACT" action of "MYSTRAT" strategy
#-------------------------------------------------------------
Scenario:I verify error message where suggestion structure not created on "<actionName>" action of "<strategyName>" strategy
  And errorMessageText can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() ="$<strategyName>"]]/ancestor::stl-expansion-panel//button//span[text()[normalize-space() = 'Save Strategy']]//ancestor::*[contains(@class,"stl-strategy-form-buttons")]//stl-form-error-message"
  And errorMessageText should be "${suggestionMissingErrorMsg}"
  And I capture the current screenshot

@StepDef
#-------------------------------------------------------------
#Step to verify user can not edit execution days and overdraft default action of particular strategy
#Example:And I verify user is only able to edit "Execution Window" field for "Overdraft Check" action type on "MYACT" action of "MYSTRAT" strategy
#-------------------------------------------------------------
Scenario:I verify user is only able to edit "<actionType>" field for "<actionSelected>" action type on "<actionName>" action of "<strategyName>" strategy
  And value is present is defined by javascript "(function() {return "$<actionType>" != "''"})()"
  And I show "$<actionName>" action menu options for "$<strategyName>" strategy
  And propertyDropdown can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-form-field//label[text()[normalize-space() = "Execution Days"]]/ancestor::stl-form-field//select"
  And propertyDropdown should be disabled if value is present
  And actionPropertyDropdown can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-action-form//label[text()[normalize-space() = "Type"]]/ancestor::stl-form-field//select"
  And actionPropertyDropdown should be disabled if value is present
  And actionPropertyDropdown text should be "$<actionSelected>" if value is present
  And actionPropertyDropdown can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-action-form//label[text()[normalize-space() = "$<actionType>"]]/ancestor::stl-form-field//select"
  And actionPropertyDropdown should be enabled if value is present

@StepDef
#-------------------------------------------------------------
#Step to save fund
#Example:And I save changes to account group "FUND32"
#-------------------------------------------------------------
Scenario:I save changes to account group "<accountGroupName>"
  And I save and confirm account group
  And I wait for header
  And header should be "$<accountGroupName>"

@StepDef
@DataTable(header="top")
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to edit suggestion in specific action of particular strategy
#Example:And I edit "MYACT" action of type "Sweep" to execution window "3 Days" for "Default strategy for 'FND32'" strategy
#|Suggestion|SuggestionValue|
#|Primary Currency|USD|
#|AED Primary Account|HDFAEDAC1|
#--------------------------------------------------------------------------------------
Scenario:I edit "<actionName>" action of type "<actionType>" to execution window "<executionWindow>" for "<strategyName>" strategy
  And I show "$<actionName>" action menu options for "$<strategyName>" strategy
  And I verify user is only able to edit "Execution Window" field for "$<actionType>" action type on "$<actionName>" action of "$<strategyName>" strategy
  And executionWindowPresent is defined by javascript "(function(){return ("$<executionWindow>" != "''") })()"
  And I change Execution Window to "$<executionWindow>" for "$<actionName>" action of "$<strategyName>" strategy if executionWindowPresent
  And I add in suggest structure "${data[Suggestion]}" with value "${data[SuggestionValue]}" for "$<strategyName>" strategy with "$<actionName>" action for each data record
  And I click on create suggestion for "$<actionName>" action of "$<strategyName>" strategy
  And I save and confirm account group 

@StepDef
#-------------------------------------------------------------
#Step to verify sweep pair dashboard
#Example:And I verify sweep pair dashboard csv extract for "MYACT" action of "MYSTRAT" strategy as "TC100"
#-------------------------------------------------------------
Scenario:I verify sweep pair dashboard csv extract for "<actionName>" action of "<strategyName>" strategy as "<testcaseNo>"
  And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
  And I remove sort on "ID" in sweep pair grid for "$<strategyName>" strategy with "$<actionName>" action
  And I scroll to the top of suggestSturcture
  And I sort ascending on "Account Code" in sweep pair grid for "$<strategyName>" strategy with "$<actionName>" action
  And I scroll to the top of suggestSturcture
  And first row of sweepPairGrid can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-expansion-panel[1]//ag-grid-angular//div[@row-index="0"]//div[@col-id="status"]"
  And I wait for first row of sweepPairGrid
  And I right click first row of sweepPairGrid
  And I wait for export button
  And I click export button
  And export to csv button should be displayed
  And export to excel button should be displayed
  And dropdownList is defined by javascript "(function(){return $('.ag-menu').length})()"
  And dropdownList should be "2"
  And I wait for export to csv button
  And I click export to csv button
  And I save file using "," as delimiter with sort on "none" for "$<testcaseNo>"
  And I compare result for "$<testcaseNo>"
  And testcaseIs is "$<testcaseNo>:''"
  And I verify testresult of testcasesno "${testcaseNoIs}" for each testcaseNoIs in testcaseIs delimited by ":"

@StepDef
#-------------------------------------------------------------
#Step to get currencyList for account group
#Example:And I get currencies in List for account group "FUND32"
#-------------------------------------------------------------
Scenario:I get currencies in <variable> for account group "<accountGroupName>"
  And $<variable> is defined by sql "select listagg(CURRENCY,',') within group (order by CURRENCY) FROM(select distinct C.CURRENCY from cms_ref_fund F inner join CMS_REF_FUND_ACCOUNT A on F.ID = A.FUND_ID inner join cms_ref_account_param C on C.ACCOUNT_ID = A.ACCOUNT_ID where F.Name='$<accountGroupName>')" in the ${dbName} database

@StepDef
#-------------------------------------------------------------
#Step to get currencyList for account group
#Example:And I get accounts associated with "GBP" currency in List for account group "FUND32"
#-------------------------------------------------------------
Scenario:I get accounts associated with "<currency>" currency in <variable> for account group "<accountGroupName>"
  And $<variable> is defined by sql "select listagg(name,',') within group (order by name) FROM(select C.name from cms_ref_fund F inner join CMS_REF_FUND_ACCOUNT A on F.ID = A.FUND_ID inner join cms_ref_account_param C on C.ACCOUNT_ID = A.ACCOUNT_ID where F.Name='$<accountGroupName>' and C.CURRENCY='$<currency>')" in the ${dbName} database

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to check order of field options is ascending for strategy
#Example:And I check order in suggest structure of "Primary Currency" is "Ascending" for "MYSTRAT" strategy with "MYACT" action
#--------------------------------------------------------------------------------------
Scenario:I check order in suggest structure of "<suggestion>" is "<value>" for "<strategyName>" strategy with "<actionName>" action
  And value is present is defined by javascript "(function() {return "$<value>" != "''"})()"
  And orderCheckSuccess is defined by javascript
  """
    (function(){
    	var result=true;var previousLetter="";
    	var suggestStructureSelectNode=document.evaluate("//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = \"$<strategyName>\"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = \"$<actionName>\"]]/ancestor::stl-expansion-panel[1]//div[text()[normalize-space() = \"Suggest New Structure\"]]/ancestor::stl-sweep-action-form//label[text()[normalize-space() = \"$<suggestion>\"]]/ancestor::stl-form-field//select", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
  	var suggestStructureOptionsNode=suggestStructureSelectNode.options;
  	for (i=0;i<suggestStructureOptionsNode.length;i++){
      if(i==0)
		    previousLetter=suggestStructureOptionsNode[i].text;
  		//console.log(suggestStructureOptionsNode[i].text);
  		//console.log(suggestStructureOptionsNode[i].text+" "+previousLetter+" "+(suggestStructureOptionsNode[i].text >= previousLetter));
  		if((suggestStructureOptionsNode[i].text >= previousLetter && "$<value>"=="Ascending") || (suggestStructureOptionsNode[i].text <= previousLetter && "$<value>"=="Descending" )){
  		     result=true;
  	    }
  		else{
  			result=false;
  			break;
  		}
  		 previousLetter=suggestStructureOptionsNode[i].text;
  	}
    	return result;
    })()
    """
    And orderCheckSuccess should be "true" if value is present

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Remove sorting on sweep pair grid
#Example:And I remove sort on "ID" in sweep pair grid for "MYSTRAT" strategy with "MYACT" action
#Example:And I remove sort on "ID,Account Code" in sweep pair grid for "MYSTRAT" strategy with "MYACT" action
#--------------------------------------------------------------------------------------
Scenario: I remove sort on "<columnName>" in sweep pair grid for "<strategyName>" strategy with "<actionName>" action
  And columnName is "$<columnName>"
  And multipleSort is defined by javascript "(function() {return "${columnName}".indexOf(',')>0})();"
  And singleSort is defined by javascript "(function() {return "${columnName}".indexOf(',')<0})();"
  And I perform remove sort action on "${columnNameTo}" in sweep pair grid for "$<strategyName>" strategy with "$<actionName>" action for each columnNameTo in columnName delimited by ","

@StepDef
Scenario: I perform remove sort action on "<columnName>" in sweep pair grid for "<strategyName>" strategy with "<actionName>" action
  And isSorted is defined by javascript
  """
  (function(){
      var isSorted=false;
      var checkAscendingSortAbsent=document.evaluate("//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = \"$<strategyName>\"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = \"$<actionName>\"]]/ancestor::stl-expansion-panel[1]//ag-grid-angular//div[@class='ag-header-row']//span[text()[normalize-space() = \"$<columnName>\"]]//ancestor::div[@ref='eLabel']//span[@ref='eSortAsc'][contains(@class,'ag-hidden')] ", document, null,XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
      var checkDescendingSortAbsent=document.evaluate("//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = \"$<strategyName>\"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = \"$<actionName>\"]]/ancestor::stl-expansion-panel[1]//ag-grid-angular//div[@class='ag-header-row']//span[text()[normalize-space() = \"$<columnName>\"]]//ancestor::div[@ref='eLabel']//span[@ref='eSortDesc'][contains(@class,'ag-hidden')] ", document, null,XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
      if (checkAscendingSortAbsent==null || checkDescendingSortAbsent==null)
        isSorted=true;
      return isSorted;
  })()
  """
  And sortRemoveOption can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-expansion-panel[1]//ag-grid-angular//div[@class="ag-header-row"]//span[text()[normalize-space() = "$<columnName>"]]"
  And I SHIFT click sortRemoveOption while isSorted using 1 second delay
  And I scroll to first column of transaction ladder

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Add sorting on sweep pair grid
#Example:And I sort ascending on "ID" in sweep pair grid for "MYSTRAT" strategy with "MYACT" action
#Example:And I sort descending on "ID,Account Code" in sweep pair grid for "MYSTRAT" strategy with "MYACT" action
#--------------------------------------------------------------------------------------
Scenario: I sort <sortType> on "<columnName>" in sweep pair grid for "<strategyName>" strategy with "<actionName>" action
  And columnName is "$<columnName>"
  And multipleSort is defined by javascript "(function() {return "${columnName}".indexOf(',')>0})();"
  And singleSort is defined by javascript "(function() {return "${columnName}".indexOf(',')<0})();"
  And I apply $<sortType> sort on "${columnNameTo}" in sweep pair grid for "$<strategyName>" strategy with "$<actionName>" action for each columnNameTo in columnName delimited by ","

@StepDef
Scenario: I apply <sortType> sort on "<columnName>" in sweep pair grid for "<strategyName>" strategy with "<actionName>" action
  And isUnsorted is defined by javascript
  """
  (function(){
      var isUnsorted=true;
      var checkAscendingSortAbsent=document.evaluate("//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = \"$<strategyName>\"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = \"$<actionName>\"]]/ancestor::stl-expansion-panel[1]//ag-grid-angular//div[@class='ag-header-row']//span[text()[normalize-space() = \"$<columnName>\"]]//ancestor::div[@ref='eLabel']//span[@ref='eSortAsc'][contains(@class,'ag-hidden')] ", document, null,XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
      var checkDescendingSortAbsent=document.evaluate("//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = \"$<strategyName>\"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = \"$<actionName>\"]]/ancestor::stl-expansion-panel[1]//ag-grid-angular//div[@class='ag-header-row']//span[text()[normalize-space() = \"$<columnName>\"]]//ancestor::div[@ref='eLabel']//span[@ref='eSortDesc'][contains(@class,'ag-hidden')] ", document, null,XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
      if (checkDescendingSortAbsent!=null && "$<sortType>"=="ascending" && checkAscendingSortAbsent==null)
        isUnsorted=false;
      if (checkAscendingSortAbsent!=null && "$<sortType>"=="descending" && checkDescendingSortAbsent==null)
        isUnsorted=false;

      return isUnsorted;
  })()
  """
  And sortRemoveOption can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-expansion-panel[1]//ag-grid-angular//div[@class="ag-header-row"]//span[text()[normalize-space() = "$<columnName>"]]"
  And I SHIFT click sortRemoveOption while isUnsorted using 1 second delay
  And I scroll to first column of transaction ladder

@StepDef
#-------------------------------------------------------------
#Step to verify for field option are specific action of particular strategy
#Example:And I verify for "Execution Window" action type field options are "1 Day,2 Days" for "MYACT" action of "MYSTRAT" strategy
#-------------------------------------------------------------
Scenario:I verify for "<property>" action type field options are "<values>" for "<actionName>" action of "<strategyName>" strategy
  And value is present is defined by javascript "(function() {return "$<values>" != "''"})()"
  And I show "$<actionName>" action menu options for "$<strategyName>" strategy if value is present
  And checkValuesArePresent is defined by javascript
  """
  (function(){
    var result=false;var valuesAre="$<values>".split(",");var matchCount=0;
    var actionPropertySelectNode=document.evaluate("//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = \"$<strategyName>\"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = \"$<actionName>\"]]/ancestor::stl-action-form//label[text()[normalize-space() = \"$<property>\"]]/ancestor::stl-form-field//select", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
    var actionPropertyOptions=actionPropertySelectNode.options;
    if(valuesAre.includes(" ")){
			matchCount++;
		}
    for (i=0;i<actionPropertyOptions.length;i++){
      if (valuesAre.includes(actionPropertyOptions[i].text) && actionPropertyOptions[i].hidden!=true){
        matchCount++;
      }
    }
    if(valuesAre.length==matchCount && actionPropertyOptions.length==matchCount){
         result=true;
    }
    return result;
  })()
    """
  And checkValuesArePresent should be "true" if value is present
  And valuesAre is "$<values>"
  And I change $<property> to "${valueIs}" for "$<actionName>" action of "$<strategyName>" strategy for each valueIs in valuesAre delimited by "," if value is present

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to check user can not add action for particular strategy
#Example: And I check user can not add action for "MYSTRAT" strategy
#--------------------------------------------------------------------------------------
Scenario:I check user can not add action for "<strategyName>" strategy
  And I show "$<strategyName>" strategy menu options
  And addActionOnStrategyButton can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]//ancestor::div[contains(@class,'stl-expansion-panel-header')]//stl-icon/i[contains(@class,'fa-plus')]"
  And addActionOnStrategyButton should not be displayed

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to check user can not add action for particular strategy
#Example: And I check user can not add strategy
#--------------------------------------------------------------------------------------
Scenario:I check user can not add strategy
  And I scroll to the bottom of strategiesHeader
  And addStrategyButton should not be displayed

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to verify property of action for specific strategy
#Example: And I verify "MYACT" action of "MYSTRAT" strategy is not present
#--------------------------------------------------------------------------------------
Scenario:I verify "<actionName>" action of "<strategyName>" strategy is not present
And I scroll to the top of strategiesHeader
And I show "$<strategyName>" strategy menu options
And showHideActionMenuButton can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]//ancestor::div[contains(@class,'stl-expansion-panel-header')]//stl-icon/i[contains(@class,'fa-angle')]"
And showHideActionMenuButton should not be displayed

@StepDef
#######################################################################################
#----------------------------------------------------------------------------------------
#Step to add new strategy on account group dashboard
#Example:And I add new strategy as "MYSTRAT" having "3" execution days with "MYACT" of type "Sweep" having "3" execution window and suggestion of Primary Currency with value "HDF"
#----------------------------------------------------------------------------------------
Scenario: I verify error message on trying to save action "<actionName>" of type "<actionType>" having execution window "<executionWindow>" for "<strategyName>" strategy without suggestions
 And I add action "$<actionName>" of type "$<actionType>" having execution window "$<executionWindow>" for "$<strategyName>" strategy
 And I save and cancel account group
 And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
 And errorMessageText can be located by javascript "$('stl-form-error-message').last()"
 And errorMessageText should be "${suggestionMissingErrorMsg}"


  @StepDef
  @DataTable(header="top")
  Scenario: I validate status of sweep pair for "<actionName>" action of "<strategyName>" strategy
      And I validate sweep pair having parent account "${data[parentAccount]}" and child account "${data[childAccount]}" for "$<actionName>" action of "$<strategyName>" strategy is "${data[status]}" for each data record


 @StepDef
 #-------------------------------------------------------------
 #Step to verify status of sweep pair
 #Example:And I validate sweep pair having parent account "parentAccount" and child account "childAccount" for "<actionName>" action of "<strategyName>" strategy is "<status>"
 #-------------------------------------------------------------
 Scenario: I validate sweep pair having parent account "<parentAccount>" and child account "<childAccount>" for "<actionName>" action of "<strategyName>" strategy is "<status>"
    And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
    And filterIs is "Account Code:$<childAccount>"
    And parentAccount is present is defined by javascript "(function() {return "$<parentAccount>" != "''" && "$<parentAccount>" != "" })()"
    And noParentAccount is present is defined by javascript "(function() {return "$<parentAccount>" == "''" || "$<parentAccount>" == "" })()"
    And I enter filter on sweep suggestions "${selectFilter}" for each selectFilter in filterIs delimited by ";"
    And statusColumn can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'status')]" if noParentAccount is present
    And statusColumn can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'parentAccount')][text()[normalize-space() = '$<parentAccount>']]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'status')]" if parentAccount is present
    And statusColumn should be "$<status>"
    And I remove filter on sweep suggestions "${selectFilter}" for each selectFilter in filterIs delimited by ";"


  @StepDef
  Scenario: I update region "<regionName>" of account group "<fundName>"
  And I update the ${dbName} database by sql "update cms_ref_account_param set region_name='$<regionName>' where name like '$<fundName>%'"

 @StepDef
  Scenario:I verify sweep pair for strategy "<strategyName>" having action "<actionName>" should be present
  And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
  And sweepPairGrid can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-expansion-panel[1]//ag-grid-angular//div[@row-index="0"]//div[@col-id="status"]"
  And sweepPairGrid should be displayed

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to check order of account code list is in ascending or descending order for the FUND
#Example:And I check order of "ACCOUNTS INCLUDED" is "Ascending" for "FND17" FUND
#Example:And I check order of "ACCOUNTS AVAILABLE" is "Ascending" for "FND17" FUND
#--------------------------------------------------------------------------------------
Scenario:I check order of "<accountCodeDropdown>" is "<value>" for "<fundName>" FUND 
  And value is present is defined by javascript "(function() {return "$<value>" != "''"})()"
  And accountOrderCheckSuccess is defined by javascript
  """
    (function(){
    	var result=true;var previousLetter="";
    	var accountCodeSelectNode=document.evaluate("//p[contains(text(),\"$<accountCodeDropdown>\")]//ancestor::div[1]/following-sibling::select", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
  	var accountCodeOptionsNode=accountCodeSelectNode.options;
  	for (i=0;i<accountCodeOptionsNode.length;i++){
      if(i==0)
		    previousLetter=accountCodeOptionsNode[i].text.toLowerCase();
  		//console.log(accountCodeOptionsNode[i].text.toLowerCase());
  		//console.log(accountCodeOptionsNode[i].text.toLowerCase()+" "+previousLetter.toLowerCase()+" "+(accountCodeOptionsNode[i].text.toLowerCase() >= previousLetter.toLowerCase()));
  		if((accountCodeOptionsNode[i].text.toLowerCase() >= previousLetter.toLowerCase() && "$<value>"=="Ascending") || (accountCodeOptionsNode[i].text.toLowerCase() <= previousLetter.toLowerCase() && "$<value>"=="Descending" )){
  		     result=true;
  	    }
  		else{
  			result=false;
  			break;
  		}
  		 previousLetter=accountCodeOptionsNode[i].text.toLowerCase();
  	}
    	return result;
    })()
    """
    And accountOrderCheckSuccess should be "true" if value is present

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to verify suggestion in specific action of particular strategy is not present
#Example:I verify in suggest structure "AUD Primary Account" for "Default strategy for 'FND17'" strategy with "SWEEP ACT" action is not present
#--------------------------------------------------------------------------------------
Scenario:I verify in suggest structure "<suggestion>" for "<strategyName>" strategy with "<actionName>" action is not present
  And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
  And primary account is not present is defined by javascript
  """
      (function(){
      var res=false;
      primaryAccountTextNode=document.evaluate("//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = \"$<strategyName>\"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = \"$<actionName>\"]]/ancestor::stl-expansion-panel[1]//div[text()[normalize-space() = 'Suggest New Structure']]/ancestor::stl-sweep-action-form//label[text()[normalize-space() = '$<suggestion>']]", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
      $('stl-label [for="primary-account"]').each(function (){
          if($(this).text()!= "$<suggestion>"){
            console.log($(this).text());
            if(primaryAccountTextNode==null || primaryAccountTextNode=='' || primaryAccountTextNode==undefined){	
            res= true;
                  }
              }else{
            console.log("Else"+ $(this).text());
              res=false;
              return false;
                  } 
      })   
      return res;
      })();
  """
  And primary account is not present should be "true"


@StepDef
#-----------------------------------------------------------------
#Step to verify sweep pair can not be a part of sweep
#Example: And I verify sweep pair having parent account "" and child account "FND17AEDC2" with status "NON FUNDED" for "SWEEP ACT" action of "Default strategy for 'FND17'" strategy can not be part of sweep
#-----------------------------------------------------------------
Scenario: I verify sweep pair having parent account "<parentAccount>" and child account "<childAccount>" with status "<status>" for "<actionName>" action of "<strategyName>" strategy can not be part of sweep
    And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
    And filterIs is "Account Code:$<childAccount>"
    And I enter filter on sweep suggestions "${selectFilter}" for each selectFilter in filterIs delimited by ";"
    And parentAccount is present is defined by javascript "(function() {return "$<parentAccount>" != "''" && "$<parentAccount>" != "" })()"
    And noParentAccount is present is defined by javascript "(function() {return "$<parentAccount>" == "''" || "$<parentAccount>" == "" })()"
    And statusColumn can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'status')]" if noParentAccount is present
    And statusColumn can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'parentAccount')][text()[normalize-space() = '$<parentAccount>']]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'status')]" if parentAccount is present
    And statusColumn should be "$<status>"
    And rowToBeSelected can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]" if noParentAccount is present
    And rowToBeSelected can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'parentAccount')][text()[normalize-space() = '$<parentAccount>']]" if parentAccount is present
    And rowIsGreyedOut is defined by javascript
    """
    (function(){
        var rowNode;var isGredOut=false;
        if("${parentAccount is present}"=="true")
          rowNode=document.evaluate("//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'parentAccount')][text()[normalize-space() = '$<parentAccount>']]", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
        if("${noParentAccount is present}"=="true")
          rowNode=document.evaluate("//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
        if((rowNode.getAttribute('style').indexOf("opacity: 0.3; filter: alpha(opacity = 30)"))>0)
          isGredOut=true;
        return isGredOut;
    })()
    """
    And rowIsGreyedOut should be "true"
    And I click rowToBeSelected
    And I right click rowToBeSelected
    And excludeSweepButton should not be displayed
    And includeSweepButton should not be displayed
    And export button should be displayed
    And I remove filter on sweep suggestions "${selectFilter}" for each selectFilter in filterIs delimited by ";"
    


@StepDef
#-----------------------------------------------------------------
#Step to include or exclude in structure of sweep pair
#Example: And I "include" all "PROPOSED" sweep pairs for "MYACT" action of "Default strategy for 'FND32'" strategy
#Example: And I "exclude" all "PROPOSED" sweep pairs for "MYACT" action of "Default strategy for 'FND32'" strategy
#-----------------------------------------------------------------    
Scenario: I "<actionToPerform>" all "<status>" sweep pairs for "<actionName>" action of "<strategyName>" strategy
  And I only click edit account group 
  And I enter filter on sweep suggestions "Status:$<status>"
  And I COMMAND+CONTROL click pairRow for each pairRow located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@role,"row")]"
  And rowToClick can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@role,"row")]"
  And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
  And I scroll to the top of rowToClick
  And I right click rowToClick
  And I click $<actionToPerform>SweepButton 
  And I save and confirm account group

@StepDef
#-----------------------------------------------------------------
#Step to scroll to structure of sweep pair
#Example: And I scroll to the suggest structure for "MYACT" action of "Default strategy for 'FND32'" strategy
#-----------------------------------------------------------------
Scenario: I scroll to the suggest structure for "<actionName>" action of "<strategyName>" strategy
  And suggestSturcture can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//stl-action-form//label[text()[normalize-space() = "$<actionName>"]]/ancestor::stl-expansion-panel[1]//div[text()[normalize-space() = 'Suggest New Structure']]"
  And I wait for suggestSturcture
  And I scroll to the top of suggestSturcture

@StepDef
#-------------------------------------------------------------
#Step to select sweep
#Example:And I select all sweep pairs in structure for "MYACT" action of "Default strategy for 'FND32'" strategy
#-------------------------------------------------------------
Scenario: I select all sweep pairs in structure for "<actionName>" action of "<strategyName>" strategy
  And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
  And selectAllSweepPair can be located by xpath "//div[contains(@class,'ag-header-viewport')]//span[contains(@class,'ag-header-select-all')][@ref="cbSelectAll"][1]"
  And I click selectAllSweepPair

@StepDef
@DataTable(header="top")
#-------------------------------------------------------------
#Step to verify 
#Example:And I verify options of sweep pair for "MYACT" action of "Default strategy for 'FND32'" strategy
#-------------------------------------------------------------
Scenario: I verify options of sweep pair for "<actionName>" action of "<strategyName>" strategy
    And I only click edit account group
    And I verify sweep pair "${data[sweepPairs]}" is having "${data[include]}" and "${data[exclude]}" options for "$<actionName>" action of "$<strategyName>" strategy for each data record

@StepDef
#-------------------------------------------------------------
#Step to select sweep
#Example:And I verify sweep pair "<sweepPairs>" is having "<includedPresesnt>" and "<excludedPresesnt>" options for "MYACT" action of "Default strategy for 'FND32'" strategy
#-------------------------------------------------------------
Scenario: I verify sweep pair "<sweepPairs>" is having "<includedPresesnt>" and "<excludedPresesnt>" options for "<actionName>" action of "<strategyName>" strategy
  And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
  And sweepPairsAre is "$<sweepPairs>"
  And I select pair "${sweepPair}" for "$<strategyName>" strategy with "$<actionName>" action for each sweepPair in sweepPairsAre delimited by ";"
  And I right click rowToBeSelected
  And includedVisible is defined by javascript "(function(){return "$<includedPresesnt>"=="present" })()"
  And includedNotVisible is defined by javascript "(function(){return "$<includedPresesnt>"=="absent" })()"
  And excludedVisible is defined by javascript "(function(){return "$<excludedPresesnt>"=="present" })()"
  And excludedNotVisible is defined by javascript "(function(){return "$<excludedPresesnt>"=="absent" })()"
  And excludeSweepButton should be displayed if excludedVisible
  And includeSweepButton should be displayed if includedVisible
  And excludeSweepButton should not be displayed if excludedNotVisible
  And includeSweepButton should not be displayed if includedNotVisible
  And export button should be displayed
  And I select all sweep pairs in structure for "$<actionName>" action of "$<strategyName>" strategy
  And I unselect all sweep pairs for "$<strategyName>" strategy with "$<actionName>" action

@StepDef
#-------------------------------------------------------------
#Step to select sweep
#Example:And I unselect all sweep pairs for "$<strategyName>" strategy with "$<actionName>" action
#-------------------------------------------------------------
Scenario: I unselect all sweep pairs for "<strategyName>" strategy with "<actionName>" action
  And allCheckboxSelected is defined by javascript
  """
  (function(){
      var stillSelected=false;
      var selectAllCheckboxNode=document.evaluate("//div[contains(@class,'ag-header-viewport')]//span[contains(@class,'ag-header-select-all')][@ref='cbSelectAll'][1]//span[contains(@class,'ag-checkbox-unchecked ag-hidden')]", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
      if(selectAllCheckboxNode==null || selectAllCheckboxNode==undefined || selectAllCheckboxNode =="")
        stillSelected=true;
      return stillSelected;
  })()
  """
  And I select all sweep pairs in structure for "$<actionName>" action of "$<strategyName>" strategy until allCheckboxSelected

 
@StepDef
#-------------------------------------------------------------
#Step to select sweep
#Example:And I select pair "${sweepPair}" for "$<strategyName>" strategy with "$<actionName>" action
#-------------------------------------------------------------
Scenario: I select pair "<sweepPair>" for "<strategyName>" strategy with "<actionName>" action
  And sweepPairIs is "$<sweepPair>"
  And sweepPairParentIs is defined by javascript
  """
  (function() {
    var valIs = "${sweepPairIs}".split(':');
    return valIs[0];
  })()
  """
  And sweepPairParent is "${sweepPairParentIs}"
  And sweepPairChildIs is defined by javascript
  """
  (function() {
    var valIs = "${sweepPairIs}".split(':');
    return valIs[1];
  })()
  """
  And sweepPairChild is "${sweepPairChildIs}"
  And I select sweep pair for parent account "${sweepPairParent}" and child account "${sweepPairChild}" for "$<actionName>" action of "$<strategyName>" strategy


@StepDef
#-------------------------------------------------------------
#Step to select sweep pair
#Example:And I select sweep pair for parent account "parentAccount" and child account "childAccount" for "<actionName>" action of "<strategyName>" strategy
#-------------------------------------------------------------
Scenario: I select sweep pair for parent account "<parentAccount>" and child account "<childAccount>" for "<actionName>" action of "<strategyName>" strategy
    And I scroll to the suggest structure for "$<actionName>" action of "$<strategyName>" strategy
    And filterIs is "Account Code:$<childAccount>"
    And I enter filter on sweep suggestions "${selectFilter}" for each selectFilter in filterIs delimited by ";"
    And parentAccount is present is defined by javascript "(function() {return "$<parentAccount>" != "''" && "$<parentAccount>" != "" })()"
    And noParentAccount is present is defined by javascript "(function() {return "$<parentAccount>" == "''" || "$<parentAccount>" == "" })()"
    And rowToBeSelected can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]" if noParentAccount is present
    And rowToBeSelected can be located by xpath "//ag-grid-angular//div[contains(@class,'ag-body-viewport')]//div[contains(@col-id,'accountCode')][text()[normalize-space() = '$<childAccount>']]//ancestor::div[contains(@role,'row')]//div[contains(@col-id,'parentAccount')][text()[normalize-space() = '$<parentAccount>']]" if parentAccount is present
    And I COMMAND+CONTROL click rowToBeSelected
    And I remove filter on sweep suggestions "${selectFilter}" for each selectFilter in filterIs delimited by ";"

@StepDef
@DataTable(header="top")
 #-------------------------------------------------------------
 #Step to verify invalid EmailId on Account group form
 #Example:And I verify invalid message on account group form field
 #Example:And I verify valid message on account group form field
 #-------------------------------------------------------------
 Scenario:I verify "<validity>" message on account group form field
    And I verify "$<validity>" "${data[field]}" with "${data[text]}" gives "${data[message]}" for each data record


@StepDef
 #-------------------------------------------------------------
 #Step to verify invalid EmailId on Account group form
 #Example:And I verify invalid email
 #-------------------------------------------------------------
 Scenario:I verify "<validity>" "<field>" with "<text>" gives "<message>"
    And I add "$<text>" in "$<field>" for account group form
    And I save and cancel account group
    And checkInvalid is defined by javascript "(function(){return '$<validity>'=='invalid'})()"
    And checkValid is defined by javascript "(function(){return '$<validity>'=='valid'})()"
    And idForField is defined by javascript ""$<field>".toLowerCase().replace(/ /g,'-')" 
    And errorMessageNode can be located by xpath "//input[@id='${idForField}']/following-sibling::stl-account-group-form-error//div[@class='stl-form-error-popup-body']" if checkInvalid
    And errorMessageNode should be "$<message>" if checkInvalid

    And noErrorMessage is defined by javascript 
    """
      (function(){  
          var result=true;
          var errorMessageBox=document.evaluate("//input[@id='${idForField}']/following-sibling::stl-account-group-form-error//div[@class='stl-form-error-popup-body']", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
          if(errorMessageBox==null || errorMessageBox=='' || errorMessageBox== undefined ){
              result=true;
            }
          else{
            result=false;
          }
          return result;
        })()
    """
    
    And noErrorMessage should be "true" if checkValid

@DataTable(header="top")
@StepDef
#-------------------------------------------------------------
#Step to verify column is present on account group dashboard
#Example:And I check for the column
#-------------------------------------------------------------
Scenario:I verify column on account group dashboard
      And I verify column "${data[column]}" on account group dashboard for each data record

@StepDef
#-------------------------------------------------------------
#Step to verify column is present on account group dashboard
#Example:And I check for the column
#-------------------------------------------------------------
Scenario:I verify column "<columnName>" on account group dashboard
      And I scroll to account group ladder column "$<columnName>" 
      And I scroll to first column of account group ladder

@StepDef
#-------------------------------------------------------------
#Step to save account group and confirm
#Example:And I save and confirm account group 
#-------------------------------------------------------------
Scenario:I save and confirm account group
    And I only click save account group
    And I wait 5 seconds 
    And confirmButtonVisible is defined by javascript "$('button:contains("Confirm"):visible').get(0)!=null"
    And I click confirmButton if confirmButtonVisible
    And I wait until "(function(){return $('button:contains("Confirm"):visible').get(0)==null })()"
    ##WA##And okButtonVisible is defined by javascript "$('button:contains("OK"):visible').get(0)!=null"
    ##WA##And I click okButton if okButtonVisible
    ##WA##And I wait for okButton
    And I wait 3 seconds
    And I wait until "(function(){return $('button:contains("OK"):visible').get(0)==null })()"
  
@StepDef
#-------------------------------------------------------------
#Step to save account group and cancel
#Example:And I save and cancel account group 
#-------------------------------------------------------------
Scenario:I save and cancel account group
    And I only click save account group
    And I only click cancel save account group 

@StepDef
#-------------------------------------------------------------
#Step to save account group
#Example:And I only click save account group 
#-------------------------------------------------------------
Scenario:I only click save account group
    And saveButtonVisible is defined by javascript "$('div.btn:contains("Save"):visible').get(0)!=null"
    And I scroll to the bottom of saveButton if saveButtonVisible
    And I click saveButton if saveButtonVisible
    And I wait 5 seconds

@StepDef
#-------------------------------------------------------------
#Step to cancel saving the account group
#Example:And I only click cancel save account group 
#-------------------------------------------------------------
Scenario:I only click cancel save account group
    And cancelButtonVisible is defined by javascript "$('stl-validation-prompt-dialog button:contains("Cancel"):visible').get(0)!=null"
    And I scroll to the bottom of cancelButtonInValidationPrompt if cancelButtonVisible
    And I wait for cancelButtonInValidationPrompt if cancelButtonVisible
    And I click cancelButtonInValidationPrompt if cancelButtonVisible
    And I wait 3 seconds

@StepDef
#-------------------------------------------------------------
#Step to only click edit account group
#Example:And I only click edit account group 
#-------------------------------------------------------------
Scenario:I only click edit account group
    And editButtonVisible is defined by javascript "$('div.btn:contains("Edit"):visible').get(0)!=null"
    And I scroll to the bottom of editButton if editButtonVisible
    And I click editButton if editButtonVisible
    And I wait 2 seconds


@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to check save strategy for particular strategy not visible
#Example: And I verify save strategy button for "MYSTRAT" strategy is not visible
#--------------------------------------------------------------------------------------
Scenario:I verify save strategy button for "<strategyName>" strategy is not visible
  And I show "$<strategyName>" strategy menu options
  And I scroll to the top of strategiesHeader
  And saveStrategyButton can be located by xpath "//stl-strategy-form/stl-expansion-panel//label[text()[normalize-space() = "$<strategyName>"]]/ancestor::stl-expansion-panel//button//span[text()[normalize-space() = 'Save Strategy']]"
  And saveStrategyButton should not be displayed
  And I capture the current screenshot

@StepDef
@DataTable(header="top")
#----------------------------------------------------------------------------------------
#Verifies error and warnings on pop up
#Example:  And I verify "2" error and "7" warning messages in popup
#    |MessageType|Message|ActionName|StrategyName|
#    |error|errorMessage|actioname|strategy|
#    |warning|warningMessage|actioname|strategy|
#----------------------------------------------------------------------------------------
Scenario:I verify "<noOfErrorMessage>" error and "<noOfWarningMessage>" warning messages in popup
  And I only click save account group
  And I verify count of "$<noOfErrorMessage>" error and "$<noOfWarningMessage>" warning messages in popup
  And I verify "${data[MessageType]}" message "${data[Message]}" in popup after save account group for "${data[ActionName]}" action of "${data[StrategyName]}" strategy for each data record
  And I capture the current screenshot
  And I only click cancel save account group


@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to verify error/warning message in popup
#Example: And I verify "error" message "errorMessage" in popup after save account group for "<actionName>" action of "<strategyName>" strategy
#Example: And I verify "warning" message "errorMessage" in popup after save account group for "<actionName>" action of "<strategyName>" strategy
#--------------------------------------------------------------------------------------
Scenario:I verify "<messageType>" message "<message>" in popup after save account group for "<actionName>" action of "<strategyName>" strategy
  And I scroll to top of page
  And checkError is defined by javascript ""$<messageType>"=="error""
  And checkWarning is defined by javascript ""$<messageType>"=="warning""
  And errorMessageTextMatched is defined by javascript
  """
  (function(){
    var actualMessage="$<message>";var result="";
    if ("$<actionName>"!="" && "$<actionName>"!="''" )
      actualMessage="$<actionName>: "+"$<message>";
    $('stl-validation-prompt-dialog div.stl-form-error-popup-body.error').each(function(){
      if($(this).text().trim()==actualMessage && $(this).css("background-color")=="rgb(224, 67, 62)")
        result=true;
    })
    return result;
  })()
  """
  And errorMessageTextMatched should be "true" if checkError
  And warningMessageTextMatched is defined by javascript
  """
  (function(){
    var actualMessage="$<message>";var result="";
    if ("$<actionName>"!="" && "$<actionName>"!="''" )
      actualMessage="$<actionName>: "+"$<message>";
    $('stl-validation-prompt-dialog div.stl-form-error-popup-body.warning').each(function(){
      if($(this).text().trim()==actualMessage && $(this).css("background-color")=="rgb(247, 156, 29)")
        result=true;
    })
    return result;
  })()
  """
  And warningMessageTextMatched should be "true" if checkWarning

@StepDef
#######################################################################################
#--------------------------------------------------------------------------------------
#Step to verify the count of error and warning messages in popup
#Example: And I verify count of "2" error and "7" warning messages in popup
#--------------------------------------------------------------------------------------
Scenario:I verify count of "<noOfErrorMessage>" error and "<noOfWarningMessage>" warning messages in popup
  And checkErrorCount is defined by javascript ""$<noOfErrorMessage>"!="0" && "$<noOfErrorMessage>"!="""
  And errorCountIsZero is defined by javascript ""$<noOfErrorMessage>"=="0" && "$<noOfErrorMessage>"!="""
  And checkWarningCount is defined by javascript ""$<noOfWarningMessage>"!="0" && "$<noOfWarningMessage>"!="""
  And errorActualCount can be located by javascript "$('stl-validation-prompt-dialog dt').get(0)"
  And warningActualCount can be located by javascript "$('stl-validation-prompt-dialog dt').get(1)" 
  And warningActualCount can be located by javascript "$('stl-validation-prompt-dialog dt').get(0)" if errorCountIsZero
  And errorActualCount text should be "Errors: $<noOfErrorMessage>" if checkErrorCount
  And warningActualCount text should be "Warnings: $<noOfWarningMessage>" if checkWarningCount
  And cancelButtonInValidationPrompt should be displayed 
  And confirmButtonNotDisplayed is defined by javascript "$('button:contains("Confirm")').get(0)==null"
  And confirmButtonNotDisplayed should be "true" if checkErrorCount
  And confirmButton should be displayed if errorCountIsZero

@StepDef
@DataTable(header="top")
#----------------------------------------------------------------------------------------
#Step to fill account group form
#Example:And I fill create account group form
##  |testcaseNo|Account Group Type|Account Group Code|Email|Group|Currency|IDEL Limit|Pool Balance Type|Pool Type|Account Group Name|Address|Description|Bank Legal Entity|FX Rate Type|accounts|
##  |TC007|Pool|TEST12234|QaAutomation@smartstream-stp.com|Default Group|INR|100000|Only Short|NOSTRO|TEST12223456|Address6|Description1|PFCLEG16|Bid Offer Rate|PFCLEG15-JPY-03|
#----------------------------------------------------------------------------------------
Scenario:I fill create account group form
  And I fill create account group form with "${data[testcaseNo]}" "${data[Account Group Type]}" "${data[Account Group Code]}" "${data[Email]}" "${data[Group]}" "${data[Currency]}" "${data[IDEL Limit]}" "${data[Pool Balance Type]}" "${data[Pool Type]}" "${data[Account Group Name]}" "${data[Address]}" "${data[Description]}" "${data[Bank Legal Entity]}" "${data[FX Rate Type]}" "${data[accounts]}" for each data record

 @StepDef
 #----------------------------------------------------------------------------------------
 #Step to create pool with given parameters
 #Example:And I fill create account group form with "TEST12123456" "Pool" "TEST121234" "QaAutomation@smartstream-stp.com " "Default Group" "INR" "100000" "Only Short" "NOSTRO" ""''" "Address7" "Description1" "PFCLEG16" "Bid Offer Rate" "''" "PFCLEG15-JPY-04" "PFCLEG15-JPY-03"
 #----------------------------------------------------------------------------------------
 Scenario:I fill create account group form with "<testcaseNo>" "<Account Group Type>" "<Account Group Code>" "<Email>" "<Group>" "<Currency>" "<IDEL Limit>" "<Pool Balance Type>" "<Pool Type>" "<Account Group Name>" "<Address>" "<Description>" "<Bank Legal Entity>" "<FX Rate Type>" "<accounts>"
   And I open create account group form
   And I select "$<Account Group Type>" from "Account Group Type" in account group form
   And I select "$<Pool Type>" from "Pool Type" in account group form
   And I add "$<Account Group Code>" in "Account Group Code" for account group form
   And I add "$<Email>" in "Email" for account group form
   And I select "$<Group>" from "Group" in account group form
   And I select "$<Currency>" from "Currency" in account group form
   And I add "$<IDEL Limit>" in "IDEL Limit" for account group form
   And I select "$<Pool Balance Type>" from "Pool Balance Type" in account group form
   And I add "$<Account Group Name>" in "Account Group Name" for account group form
   And I add "$<Address>" in "Address" for account group form
   And I add "$<Description>" in "Description" for account group form
   And I select "$<Bank Legal Entity>" from "Bank Legal Entity" in account group form
   And I select "$<FX Rate Type>" from "FX Rate Type" in account group form
   And I add accounts "$<accounts>" in account group form

@StepDef
#----------------------------------------------------------------------------------------
#Step to verify first row of grid
#Example:And I verify account group with "Name" as "FND4894" is not present
#----------------------------------------------------------------------------------------
Scenario:I verify account group with "<type>" as "<accountGroupName>" is not present
  And I apply account group filter "$<type>:$<accountGroupName>"
  And firstRowIsNotPresent is defined by javascript
  """
  (function() {
      var firstRow = $('stl-account-group-grid [row-index="0"] [col-id*="accountGroupType"]').get(0);
	      if(firstRow==null){ return true;}
	      return false;
     })();
  """ 
  And firstRowIsNotPresent should be "true"

@StepDef
#----------------------------------------------------------------------------------------
#Step to verify progress bar on account group dashboard
#Example:And I verify progress bar message for strategy "Default strategy for 'FND32'" with action "ACTION X: ACTION NAME" for account group "FND32"
#----------------------------------------------------------------------------------------
Scenario:I verify progress bar message for strategy "<strategyName>" with action "<actionName>" for account group "<accountGroupName>"
  And I only click edit account group
  And I click saveButton
  And verifyMessage is defined by javascript 
  """
    (function(){
        var progressTrackerLabel = $('tlmv-progress-tracker p.tlmv-c-progress-tracker-label').text().trim();
        var progressTrackerMessage = $('tlmv-progress-tracker p.tlmv-c-progress-tracker-message').text().trim();
        var result = false;
        console.log(progressTrackerLabel + " " + progressTrackerMessage);
        if(progressTrackerMessage=="Processing items... (Strategy:  $<strategyName>)" && progressTrackerLabel.indexOf("of 2")>=0){
          result = true;
          
        }
        return result;
    })();
  """
 And verifyMessage should be "true"
 And processFinishedMessagePrompt can be located by javascript "$('stl-validation-prompt-dialog i').siblings('span')"
 And processFinishedMessagePrompt text should be "${processFinishedMessage}"

 @StepDef
#----------------------------------------------------------------------------------------
#Step to verify remove/removeAll button is visible or invisible
#Example:And I verify "remove/removeAll" button is "visible"
#Example:And I verify "remove/removeAll" button is "invisible"
#----------------------------------------------------------------------------------------
Scenario:I verify "<type>" button is "<visibility>"
  Given statusVisible is defined by javascript "(function() {return "$<visibility>" == "visible"})();"
  And statusInVisible is defined by javascript "(function() {return "$<visibility>" == "invisible"})();"
  Then $<type> button should be displayed if statusVisible
  Then $<type> button should not be displayed if statusInVisible

@StepDef
#-----------------------------------------------------
#-----------------------------------------------------
Scenario:I select "<accounts>" accounts included in account group form
  Given accountToRemove is "$<accounts>"
  And value is present is defined by javascript "(function() {return "$<accounts>" != "''"})();"
  Then I select "${selectaccount}" in accounts selected for each selectaccount in accountToRemove delimited by ";" if value is present

  @StepDef
#-----------------------------------------------------
#-----------------------------------------------------
Scenario:I deselect "<accounts>" accounts included in account group form
  Given accountToRemove is "$<accounts>"
  And value is present is defined by javascript "(function() {return "$<accounts>" != "''"})();"
  Then I deselect "${selectaccount}" in accounts selected for each selectaccount in accountToRemove delimited by ";" if value is present

@StepDef
#----------------------------------------------------------------------------------------
#Step to verify remove/removeAll button is visible or invisible
#Example:And I verify warning message that "2" accounts removed and "1" accounts can not be removed 
#----------------------------------------------------------------------------------------
Scenario:I verify warning message that "<noOfRemovedAccounts>" accounts removed and "<noOfCanNotBeRemovedAccounts>" accounts can not be removed
  Given removedAccountsMessage is defined by javascript 
  """
  (function(){
	  if($('stl-form-error stl-form-error-message span').text().trim()=="${accountRemoveWarningMessage}$<noOfRemovedAccounts>${accountCannotBeRemovedWarningMessage}$<noOfCanNotBeRemovedAccounts>")
			  return true;
    else 
        return false;
  })()
  """
  And removedAccountsMessage should be "true"
  
  @StepDef
 ###########################################################################################################
 #----------------------------------------------------------------------------------------------------------
 #Step to select and verify filtering in create fund form
 #Example:And I apply filter "HSSACC#$" on accounts included in account group form
 #----------------------------------------------------------------------------------------------------------
 Scenario:I apply filter "<filteraccounts>" on accounts included in account group form
  Given accountIs is "$<filteraccounts>"
  And value is present is defined by javascript "(function() {return "$<filteraccounts>" != "''"})();"
  Then I enter account filter "${filteraccount}" on accounts included in account group form for each filteraccount in accountIs delimited by "," if value is present


 @StepDef
 ###########################################################################################################
 #----------------------------------------------------------------------------------------------------------
 #Step to verify account filter in create fund form
 #Example:And I enter account filter "AUTOACC1" in account group form
 #----------------------------------------------------------------------------------------------------------
 Scenario:I enter account filter "<filteraccount>" on accounts included in account group form
  Given I type "$<filteraccount>" in account filter toField for accountGroupForm
  And filtered is defined by javascript
  """
  (function(){
    str="";
    $('p:contains("ACCOUNTS INCLUDED")').parent().siblings('select').find('option').each(function(){
      if($(this).text().trim().indexOf("$<filteraccount>") >= 0)
          str="done";
      else{str="";return false;}
    });
    return str;
  })()
  """
  Then filtered should be "done"


  @StepDef
 ###########################################################################################################
 #----------------------------------------------------------------------------------------------------------
 #Step to remove filter in create fund form
 #Example:And I remove account filter from accounts included in account group form
 #----------------------------------------------------------------------------------------------------------
 Scenario:I remove account filter from accounts included in account group form
   And I clear account filter toField for accountGroupForm
   And I capture the current screenshot
   ##WA##
   And removeAccountFilterToField can be located by javascript "$('div:contains("ACCOUNTS INCLUDED") > div.stl-multi-select-search-wrapper i.fa-times')"
   And I click removeAccountFilterToField
   And options present is defined by javascript
   """
   (function(){
   str="";
   if($('p:contains("ACCOUNTS AVAILABLE")').parent().siblings('select').find('option').get(0)!=null)
       str="done";
   return str;
   })()
   """
   Then options present should be "done"

@StepDef
################################################################################################
#-----------------------------------------------------------------------------------------------
#Step to verify count of account version history records
#-----------------------------------------------------------------------------------------------
Scenario:I verify account group history versions count is "<count>"
  And recordCount is defined by javascript
  """
    (function(){
      var rowCount = 0;
      $('stl-account-group-historic-grid .ag-body-container.ag-layout-normal [role="row"]').each(function(){rowCount++;   })
      return rowCount; 
    })()
  """
  And recordCount should be "$<count>"